<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-05-08">
<meta name="description" content="Analyze relationship between variables and Phase 2 FEV1 Scores">

<title>COPD Gene Study - Final Class Project â€“ Jayna Snyder</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-3b7f4aff7acac744aa1d596ce5db2ede.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Jayna Snyder</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jsnyder82"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/jayna-snyder"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#authors" id="toc-authors" class="nav-link active" data-scroll-target="#authors">Authors</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling</a></li>
  <li><a href="#descriptive-statistics-and-exploratory-analysis" id="toc-descriptive-statistics-and-exploratory-analysis" class="nav-link" data-scroll-target="#descriptive-statistics-and-exploratory-analysis">Descriptive Statistics and Exploratory Analysis</a></li>
  <li><a href="#inference-and-modeling" id="toc-inference-and-modeling" class="nav-link" data-scroll-target="#inference-and-modeling">Inference and Modeling</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">COPD Gene Study - Final Class Project</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">Epidemiology</div>
    <div class="quarto-category">Data Visualization</div>
  </div>
  </div>

<div>
  <div class="description">
    Analyze relationship between variables and Phase 2 FEV1 Scores
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 8, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="authors" class="level3">
<h3 class="anchored" data-anchor-id="authors">Authors</h3>
<p>This project was written by Dr.&nbsp;Kyle Hasenstab as the final project for an introductory data science class taught in R at SDSU. It was completed by Jayna Snyder. Formatting has been edited for display on portfolio.</p>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Chronic obstructive pulmonary disease (COPD) affects over 16 million Americans and is the fourth leading cause of death in the United States behind heart disease, cancer, and accidental death. While COPD can result from various toxic inhalations or asthma, it is most commonly associated with cigarette smoking.</p>
<p>COPD severity is typically measured by a device called a spirometer. Patients forcefully exhale into the device and the volume of air exhaled is used as a measure for the severity of disease (less air exhaled <span class="math inline">\(\Rightarrow\)</span> worse disease). Data collected by the COPDGene research group includes spirometry data on thousands of research participants.</p>
<p>Spirometry measures in the dataset:</p>
<ul>
<li><p>The forced expiratory volume (FEV1) is the volume of air exhaled in 1 second * The forced vital capacity (FVC) is the total volume of air exhaled after a full breath</p></li>
<li><p>FEV1_FVC_ratio is the ratio between FEV1 and FVC (smaller <span class="math inline">\(\Rightarrow\)</span> worse disease)</p></li>
<li><p>FEV1_phase2 is the FEV1 of research participants 5 years later</p></li>
</ul>
<p>The overall task in this project is to analyze the relationship between FEV1 at follow-up (FEV1_phase2) and other variables in the dataset. The project has been organized into a series of tasks to assist with analysis organization.</p>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">Data Wrangling</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#necessary packages &amp; libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Import Data</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import COPD demographics data from CSV file</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>COPD_demographics <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/khasenst/datasets_teaching/refs/heads/main/copd_data_demographics.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>(COPD_demographics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2620 obs. of  18 variables:
 $ sid                     : chr  "10005Q" "10055F" "10056H" "10060Y" ...
 $ visit_year              : int  2008 2008 2008 2008 2008 2008 2008 2008 2008 2008 ...
 $ visit_date              : chr  "1/15/2008" "3/15/2008" "2/15/2008" "5/15/2008" ...
 $ visit_age               : num  54.5 69 48.7 72.8 76.2 70 61.8 69.6 47.8 71.5 ...
 $ gender                  : int  2 1 2 1 2 2 1 2 1 1 ...
 $ race                    : int  1 2 1 1 1 1 1 1 1 1 ...
 $ smoking_status          : int  2 1 1 1 1 1 1 1 2 1 ...
 $ height_cm               : num  160 178 154 177 155 ...
 $ weight_kg               : num  73 90.7 86.2 89.6 55 ...
 $ blood_pressure_systolic : int  130 168 100 147 134 92 108 144 139 140 ...
 $ blood_pressure_diastolic: int  80 100 53 71 78 58 78 90 90 75 ...
 $ heart_rate              : int  87 55 98 87 92 77 72 110 87 73 ...
 $ hours_on_oxygen         : int  0 0 24 24 0 12 0 0 0 24 ...
 $ bmi                     : num  28.6 28.6 36.5 28.6 22.9 ...
 $ smoke_start_age         : int  14 18 12 17 18 16 13 16 19 13 ...
 $ cigs_per_day_avg        : int  20 20 40 30 20 40 20 20 20 20 ...
 $ duration_smoking        : num  40.5 20 36 54 52 48 17 30 28.8 57 ...
 $ respiratory             : chr  "" "hay fever" "asthma|bronchitis attacks|chronic bronchitis|pneumonia|emphysema|copd|sleep apnea" "asthma|bronchitis attacks|chronic bronchitis|emphysema|copd" ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import COPD medical images data from JSON file</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>COPD_medical_images <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"https://raw.githubusercontent.com/khasenst/datasets_teaching/refs/heads/main/copd_data_imaging.json"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>(COPD_medical_images)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2610 obs. of  7 variables:
 $ sid                     : chr  "24838L" "14901M" "11357A" "20152J" ...
 $ lung_volume_inspiratory : num  4.2 5.78 5.5 4.94 4.65 ...
 $ emphysema_percentage    : num  1.37 3.78 4.72 8.42 0.06 ...
 $ lung_volume_expiratory  : num  2.3 2.99 2.75 3.21 2.98 ...
 $ gas_trapping_percentage : num  10.56 11.66 16.92 39.41 2.62 ...
 $ mean_density_inspiratory: num  -830 -836 -856 -851 -762 ...
 $ mean_density_expiratory : num  -685 -674 -728 -777 -656 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import COPD spirometry data from HTML file</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>html <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">"https://raw.githubusercontent.com/khasenst/datasets_teaching/refs/heads/main/copd_data_spirometry.html"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>COPD_spirometry <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">html_table</span>(html)[[<span class="dv">1</span>]])</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>(COPD_spirometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2610 obs. of  5 variables:
 $ sid           : chr  "22035P" "25109H" "10127E" "15450K" ...
 $ fev1_fvc_ratio: num  0.62 0.81 0.83 0.51 0.75 0.81 0.31 0.76 0.81 0.82 ...
 $ fev1          : num  3.67 1.97 2.32 2.4 3.94 ...
 $ fvc           : num  5.95 2.43 2.79 4.75 5.27 ...
 $ fev1_phase2   : num  3.48 2.05 2.13 1.42 3.57 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import data dictionary</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>COPD_data_dictionary <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/khasenst/datasets_teaching/refs/heads/main/copd_data_dictionary.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Merge Data Sets</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge demographics and medical images dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>COPD_data <span class="ot">&lt;-</span> <span class="fu">merge</span>( <span class="at">x =</span> COPD_demographics,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> COPD_medical_images,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by.x =</span> <span class="st">"sid"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by.y =</span> <span class="st">"sid"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># merge demographics, medical images, and spirometry datasets</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>COPD_data <span class="ot">&lt;-</span> <span class="fu">merge</span>( <span class="at">x =</span> COPD_data,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> COPD_spirometry,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by.x =</span> <span class="st">"sid"</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by.y =</span> <span class="st">"sid"</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># check dimensions of new data set</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(COPD_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2620   28</code></pre>
</div>
</div>
<p><strong>Variable Manipulation</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert numeric indicator variables into factor type with descriptive labels from data dictionary</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(COPD_data<span class="sc">$</span>gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>race <span class="ot">&lt;-</span> <span class="fu">factor</span>(COPD_data<span class="sc">$</span>race, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"White"</span>, <span class="st">"Black"</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>smoking_status <span class="ot">&lt;-</span> <span class="fu">factor</span>(COPD_data<span class="sc">$</span>smoking_status, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Never Smoked"</span>, <span class="st">"Former Smoker"</span>, <span class="st">"Current Smoker"</span>))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new height variable in inches</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>height_in <span class="ot">&lt;-</span> COPD_data<span class="sc">$</span>height_cm <span class="sc">/</span> <span class="fl">2.54</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new weight variable in pounds</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>weight_lbs <span class="ot">&lt;-</span> COPD_data<span class="sc">$</span>weight_kg <span class="sc">*</span> <span class="fl">2.2</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to date</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>visit_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(COPD_data<span class="sc">$</span>visit_date, <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert age to integer</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>visit_age <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(COPD_data<span class="sc">$</span>visit_age)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert visit year to factor</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>visit_year <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(COPD_data<span class="sc">$</span>visit_year)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert hours_on_oxygen to factor because there are only discrete options (1, 2, ..., 24 hours)</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>hours_on_oxygen <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(COPD_data<span class="sc">$</span>hours_on_oxygen)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Check work</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(COPD_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     sid visit_year visit_date visit_age gender  race smoking_status height_cm
1 10005Q       2008 2008-01-15        54 Female White Current Smoker     159.9
2 10055F       2008 2008-03-15        69   Male Black  Former Smoker     178.0
3 10056H       2008 2008-02-15        48 Female White  Former Smoker     153.7
4 10060Y       2008 2008-05-15        72   Male White  Former Smoker     177.0
5 10068O       2008 2008-03-15        76 Female White  Former Smoker     155.0
6 10072F       2008 2008-03-15        70 Female White  Former Smoker     165.1
  weight_kg blood_pressure_systolic blood_pressure_diastolic heart_rate
1      73.0                     130                       80         87
2      90.7                     168                      100         55
3      86.2                     100                       53         98
4      89.6                     147                       71         87
5      55.0                     134                       78         92
6      76.1                      92                       58         77
  hours_on_oxygen   bmi smoke_start_age cigs_per_day_avg duration_smoking
1               0 28.55              14               20             40.5
2               0 28.63              18               20             20.0
3              24 36.49              12               40             36.0
4              24 28.60              17               30             54.0
5               0 22.89              18               20             52.0
6              12 27.92              16               40             48.0
                                                                        respiratory
1                                                                                  
2                                                                         hay fever
3 asthma|bronchitis attacks|chronic bronchitis|pneumonia|emphysema|copd|sleep apnea
4                       asthma|bronchitis attacks|chronic bronchitis|emphysema|copd
5          hay fever|bronchitis attacks|chronic bronchitis|pneumonia|emphysema|copd
6                                                          pneumonia|emphysema|copd
  lung_volume_inspiratory emphysema_percentage lung_volume_expiratory
1                  5.6636               0.9269                 2.4766
2                  4.9060               1.9452                 1.9057
3                  4.8654              11.3832                 4.0606
4                  7.3304              19.2623                 5.3342
5                  6.0099              41.7757                 4.1552
6                  3.9788               2.4735                 2.8876
  gas_trapping_percentage mean_density_inspiratory mean_density_expiratory
1                  6.8008                 -830.343                -650.526
2                 10.6835                 -823.746                -638.442
3                 47.8811                 -836.281                -797.471
4                 53.4747                 -867.254                -821.256
5                 66.1621                 -903.436                -856.337
6                 31.0631                 -816.235                -747.113
  fev1_fvc_ratio  fev1   fvc fev1_phase2 height_in weight_lbs
1           0.77 2.921 3.805       2.622  62.95276     160.60
2           0.73 2.917 3.999       2.439  70.07874     199.54
3           0.29 0.374 1.281       0.379  60.51181     189.64
4           0.29 0.706 2.424       1.405  69.68504     197.12
5           0.46 0.806 1.736       0.580  61.02362     121.00
6           0.57 1.573 2.752       1.477  65.00000     167.42</code></pre>
</div>
</div>
<p><strong>Text Processing for Variable Creation</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use text processing to convert respiratory variable into separate variables by diagnosis</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>hay_fever          <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"hay fever"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>asthma             <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"asthma"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>bronchitis_attacks <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"bronchitis attacks"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>chronic_bronchitis <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"chronic bronchitis"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>pneumonia          <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"pneumonia"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>emphysema          <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"emphysema"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>copd               <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"copd"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>sleep_apnea        <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"sleep apnea"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(COPD_data[, <span class="fu">c</span>(<span class="st">"hay_fever"</span>, <span class="st">"asthma"</span>, <span class="st">"bronchitis_attacks"</span>, <span class="st">"chronic_bronchitis"</span>, <span class="st">"pneumonia"</span>, <span class="st">"emphysema"</span>, <span class="st">"copd"</span>, <span class="st">"sleep_apnea"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  hay_fever asthma bronchitis_attacks chronic_bronchitis pneumonia emphysema
1        No     No                 No                 No        No        No
2       Yes     No                 No                 No        No        No
3        No    Yes                Yes                Yes       Yes       Yes
4        No    Yes                Yes                Yes        No       Yes
5       Yes     No                Yes                Yes       Yes       Yes
6        No     No                 No                 No       Yes       Yes
  copd sleep_apnea
1   No          No
2   No          No
3  Yes         Yes
4  Yes          No
5  Yes          No
6  Yes          No</code></pre>
</div>
</div>
<p><strong>Removing Unnecessary Variables</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create new data set without height_cm, weight_kg, and respiratory columns</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>COPD_data_clean <span class="ot">&lt;-</span> COPD_data[ , <span class="sc">!</span><span class="fu">names</span>(COPD_data) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"height_cm"</span>, <span class="st">"weight_kg"</span>, <span class="st">"respiratory"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Export new dataset</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Export data as csv file</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="at">x =</span> COPD_data_clean, <span class="at">file =</span> <span class="st">"copd_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="descriptive-statistics-and-exploratory-analysis" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics-and-exploratory-analysis">Descriptive Statistics and Exploratory Analysis</h2>
<p><strong>Function for descriptive statistics</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#function that returns descriptive statistics for variable in data frame</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="cf">function</span>(var) {</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#returns mean and standard deviation for numeric and integer columns</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">class</span>(var) <span class="sc">==</span> <span class="st">"numeric"</span> <span class="sc">|</span> <span class="fu">class</span>(var) <span class="sc">==</span> <span class="st">"integer"</span>){</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    mean_var <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(var), <span class="dv">3</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    sd_var <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sd</span>(var), <span class="dv">3</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mean =</span> mean_var, <span class="at">sd =</span> sd_var))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#returns a frequency table for character or factor columns</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">table</span>(var))</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># test function on categorical variable</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stats</span>(COPD_data_clean<span class="sc">$</span>asthma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>var
  No  Yes 
2165  455 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test function on numeric variable</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stats</span>(COPD_data_clean<span class="sc">$</span>bmi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$mean
[1] 28.854

$sd
[1] 5.835</code></pre>
</div>
</div>
<p><strong>Apply the function to all columns</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply function across columns except id column</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="at">X =</span> COPD_data_clean[, <span class="fu">names</span>(COPD_data_clean) <span class="sc">!=</span> <span class="st">"sid"</span>], </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">FUN =</span> stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$visit_year
var
2008 2009 2010 2011 
 570 1186  793   71 

$visit_date
var
2008-01-15 2008-02-15 2008-03-15 2008-04-15 2008-05-15 2008-06-15 2008-07-15 
         1          1         10         38         45         48         77 
2008-08-15 2008-09-15 2008-10-15 2008-11-15 2008-12-15 2009-01-15 2009-02-15 
        76         78         85         50         61         90        103 
2009-03-15 2009-04-15 2009-05-15 2009-06-15 2009-07-15 2009-08-15 2009-09-15 
       109        102         90        114         92         93        109 
2009-10-15 2009-11-15 2009-12-15 2010-01-15 2010-02-15 2010-03-15 2010-04-15 
       110         95         79         94         77         96         78 
2010-05-15 2010-06-15 2010-07-15 2010-08-15 2010-09-15 2010-10-15 2010-11-15 
        78         72         52         62         48         40         58 
2010-12-15 2011-01-15 2011-02-15 2011-03-15 2011-04-15 
        38         21         19         20         11 

$visit_age
$visit_age$mean
[1] 59.514

$visit_age$sd
[1] 8.704


$gender
var
  Male Female 
  1333   1287 

$race
var
White Black 
 1887   733 

$smoking_status
var
  Never Smoked  Former Smoker Current Smoker 
             0           1411           1209 

$blood_pressure_systolic
$blood_pressure_systolic$mean
[1] 128.898

$blood_pressure_systolic$sd
[1] 16.712


$blood_pressure_diastolic
$blood_pressure_diastolic$mean
[1] 76.632

$blood_pressure_diastolic$sd
[1] 10.594


$heart_rate
$heart_rate$mean
[1] 74.023

$heart_rate$sd
[1] 12.202


$hours_on_oxygen
var
   0    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15 
2444    8    4    2    5    6   10   14   28    6    8    1    5    1    1    3 
  16   18   20   22   23   24 
   4    4    2    3    1   60 

$bmi
$bmi$mean
[1] 28.854

$bmi$sd
[1] 5.835


$smoke_start_age
$smoke_start_age$mean
[1] 17.071

$smoke_start_age$sd
[1] 4.552


$cigs_per_day_avg
$cigs_per_day_avg$mean
[1] 24.25

$cigs_per_day_avg$sd
[1] 11.001


$duration_smoking
$duration_smoking$mean
[1] 34.924

$duration_smoking$sd
[1] 10.403


$lung_volume_inspiratory
$lung_volume_inspiratory$mean
[1] NA

$lung_volume_inspiratory$sd
[1] NA


$emphysema_percentage
$emphysema_percentage$mean
[1] NA

$emphysema_percentage$sd
[1] NA


$lung_volume_expiratory
$lung_volume_expiratory$mean
[1] NA

$lung_volume_expiratory$sd
[1] NA


$gas_trapping_percentage
$gas_trapping_percentage$mean
[1] NA

$gas_trapping_percentage$sd
[1] NA


$mean_density_inspiratory
$mean_density_inspiratory$mean
[1] NA

$mean_density_inspiratory$sd
[1] NA


$mean_density_expiratory
$mean_density_expiratory$mean
[1] NA

$mean_density_expiratory$sd
[1] NA


$fev1_fvc_ratio
$fev1_fvc_ratio$mean
[1] NA

$fev1_fvc_ratio$sd
[1] NA


$fev1
$fev1$mean
[1] NA

$fev1$sd
[1] NA


$fvc
$fvc$mean
[1] NA

$fvc$sd
[1] NA


$fev1_phase2
$fev1_phase2$mean
[1] NA

$fev1_phase2$sd
[1] NA


$height_in
$height_in$mean
[1] 66.976

$height_in$sd
[1] 3.77


$weight_lbs
$weight_lbs$mean
[1] 184.137

$weight_lbs$sd
[1] 41.595


$hay_fever
var
  No  Yes 
1842  778 

$asthma
var
  No  Yes 
2165  455 

$bronchitis_attacks
var
  No  Yes 
1544 1076 

$chronic_bronchitis
var
  No  Yes 
2251  369 

$pneumonia
var
  No  Yes 
1704  916 

$emphysema
var
  No  Yes 
2128  492 

$copd
var
  No  Yes 
1941  679 

$sleep_apnea
var
  No  Yes 
2191  429 </code></pre>
</div>
</div>
<p>I noticed that the following variables all report NA, so missing values need to be excluded for these variables:</p>
<ul>
<li>lung_volume_inspiartory</li>
<li>emphysema_percentage</li>
<li>lung_volume_expiratory</li>
<li>gas_trapping_percentage</li>
<li>mean_density_inspiratory</li>
<li>mean_density_expiratory</li>
<li>fev1_fvc_ratio</li>
<li>fev1</li>
<li>fvc</li>
<li>fev1_phase2</li>
</ul>
<p><strong>Remove missing values and rerun descriptive statistics</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#remove rows with missing values, complete.cases returns true for each row that contains values in all columns</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>COPD_data_clean <span class="ot">&lt;-</span> COPD_data_clean[ <span class="fu">complete.cases</span>(COPD_data_clean) , ]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#check stats now return values instead of NA</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(COPD_data_clean[ , <span class="fu">names</span>(COPD_data_clean) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"lung_volume_inspiratory"</span>, <span class="st">"emphysema_percentage"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lung_volume_expiratory"</span>, <span class="st">"gas_trapping_percentage"</span>, <span class="st">"mean_density_inspiratory"</span>, <span class="st">"mean_density_expiratory"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fev1_fvc_ratio"</span>, <span class="st">"fev1"</span>, <span class="st">"fvc"</span>, <span class="st">"fev1_phase2"</span> ) ], stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$lung_volume_inspiratory
$lung_volume_inspiratory$mean
[1] 5.585

$lung_volume_inspiratory$sd
[1] 1.389


$emphysema_percentage
$emphysema_percentage$mean
[1] 5.645

$emphysema_percentage$sd
[1] 8.701


$lung_volume_expiratory
$lung_volume_expiratory$mean
[1] 3.133

$lung_volume_expiratory$sd
[1] 0.979


$gas_trapping_percentage
$gas_trapping_percentage$mean
[1] 19.027

$gas_trapping_percentage$sd
[1] 17.417


$mean_density_inspiratory
$mean_density_inspiratory$mean
[1] -832.792

$mean_density_inspiratory$sd
[1] 34.103


$mean_density_expiratory
$mean_density_expiratory$mean
[1] -704.658

$mean_density_expiratory$sd
[1] 69.892


$fev1_fvc_ratio
$fev1_fvc_ratio$mean
[1] 0.692

$fev1_fvc_ratio$sd
[1] 0.143


$fev1
$fev1$mean
[1] 2.389

$fev1$sd
[1] 0.853


$fvc
$fvc$mean
[1] 3.424

$fvc$sd
[1] 0.959


$fev1_phase2
$fev1_phase2$mean
[1] 2.179

$fev1_phase2$sd
[1] 0.837</code></pre>
</div>
</div>
<section id="visualizing-numeric-variables-with-histograms" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-numeric-variables-with-histograms">Visualizing numeric variables with histograms</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">names</span>(COPD_data_clean)) {</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">is.numeric</span>(COPD_data_clean[,col]) <span class="sc">|</span> <span class="fu">is.integer</span>(COPD_data_clean[,col])){</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>   plot <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> .data[[col]])) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">bins =</span> <span class="dv">30</span> ) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Frequency of"</span>, col)) <span class="sc">+</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_light</span>()</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(plot)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-15.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-16.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-17.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-18.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-19.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/histograms for numeric variables-20.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The following variables are highly skewed:</p>
<ul>
<li><p>fev1_fvc_ratio (left-skewed)</p></li>
<li><p>gas_trapping_percentage (right-skewed)</p></li>
<li><p>lung_volume_expiratory (right-skewed)</p></li>
<li><p>emphysema_percentage (right-skewed)</p></li>
<li><p>cigs_per_day_avg (right-skewed)</p></li>
<li><p>hours_on_oxygen (right-skewed)</p></li>
<li><p>smoke_start_age (right-skewed)</p></li>
</ul>
<p>I decided the best transformation for each variable by plotting histograms of the transformed variables to see which transformation created the most normal shaped (least skewed) distribution.</p>
<p><strong>Transform Variables and Recreate Histograms</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#transform skewed variables</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>COPD_data_clean<span class="sc">$</span>fev1_fvc_ratio_squared <span class="ot">&lt;-</span> (COPD_data_clean<span class="sc">$</span>fev1_fvc_ratio)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>COPD_data_clean<span class="sc">$</span>gas_trapping_percentage_sqrt <span class="ot">&lt;-</span>  <span class="fu">sqrt</span>(COPD_data_clean<span class="sc">$</span>gas_trapping_percentage)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>COPD_data_clean<span class="sc">$</span>lung_volume_expiratory_log <span class="ot">&lt;-</span> <span class="fu">log</span>(COPD_data_clean<span class="sc">$</span>lung_volume_expiratory)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>COPD_data_clean<span class="sc">$</span>emphysema_percentage_log <span class="ot">&lt;-</span> <span class="fu">log</span>(COPD_data_clean<span class="sc">$</span>emphysema_percentage)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>COPD_data_clean<span class="sc">$</span>cigs_per_day_avg_log <span class="ot">&lt;-</span> <span class="fu">log</span>(COPD_data_clean<span class="sc">$</span>cigs_per_day_avg)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>COPD_data_clean<span class="sc">$</span>smoke_start_age_log <span class="ot">&lt;-</span> <span class="fu">log</span>(COPD_data_clean<span class="sc">$</span>smoke_start_age)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>transformed_vars <span class="ot">&lt;-</span> COPD_data_clean[, <span class="fu">names</span>(COPD_data_clean) <span class="sc">%in%</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">c</span>(<span class="st">"fev1_fvc_ratio_squared"</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"gas_trapping_percentage_sqrt"</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"lung_volume_expiratory_log"</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"emphysema_percentage_log"</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"cigs_per_day_avg_log"</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"smoke_start_age_log"</span>)]</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">names</span>(transformed_vars)) {</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">is.numeric</span>(COPD_data_clean[,col]) <span class="sc">|</span> <span class="fu">is.integer</span>(COPD_data_clean[,col])){</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>   plot <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> .data[[col]])) <span class="sc">+</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Frequency of"</span>, col)) <span class="sc">+</span> </span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_light</span>()</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(plot)</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/transform skewed variables-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/transform skewed variables-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/transform skewed variables-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/transform skewed variables-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/transform skewed variables-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/transform skewed variables-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualize-categorical-variables-by-phase-2-fev1-scores" class="level4">
<h4 class="anchored" data-anchor-id="visualize-categorical-variables-by-phase-2-fev1-scores">Visualize Categorical Variables by Phase 2 FEV1 Scores</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing Phase 2 FEV1 scores by categorical variables</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 vs. Gender"</span>, <span class="at">x =</span> <span class="st">"Gender"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/visualize categorical vars by phase 2 FEV1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> smoking_status, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 vs. Smoking Status"</span>, <span class="at">x =</span> <span class="st">"Smoking Status"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/visualize categorical vars by phase 2 FEV1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> hay_fever, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 vs. Hay Fever"</span>, <span class="at">x =</span> <span class="st">"Hay Fever"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/visualize categorical vars by phase 2 FEV1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> asthma, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 vs. Asthma"</span>, <span class="at">x =</span> <span class="st">"Asthma"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/visualize categorical vars by phase 2 FEV1-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> copd, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 Score vs. COPD"</span>, <span class="at">x =</span> <span class="st">"COPD"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1 Score"</span>) <span class="sc">+</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/visualize categorical vars by phase 2 FEV1-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Phase 2 FEV1 vs.&nbsp;Gender</strong> There does appear to be a difference in phase 2 FEV1 score in females versus males. For females, the median phase2_fev1 is just under 2, with maximum scores up to about 3.5. For males, the median phase2_fev1 score is higher, just above 2.5, with maximum scores up to about 5. Male phase2_fev1 scores have higher variability than that for females. Neither group has outliers, and both groups have symmetrical distributions.</p>
<p><strong>Phase 2 FEV1 vs.&nbsp;Smoking Status</strong> There does not appear to be a difference in phase 2 FEV1 scores between former smokers and current smokers. Both groups have median phase2_fev1 of about 2.2, with some high outliers around 4.5 and 5. The current smoker group has slightly smaller range and variability. There is no data for nonsmokers in the dataset, so there is no way to know if there is a difference in FEV1 scores for nonsmokers.</p>
<p><strong>Phase 2 FEV1 vs.&nbsp;Hay Fever</strong> There does not appear to be any difference in phase 2 FEV1 scores for patients with or without hay fever. Patients with hay fever (â€œYesâ€ group) and patients without hay fever(â€œNoâ€ group) have a median phase 2 FEV1 score of about 2.2. Both groups have very similar variability, with range of about 4.6. Both groups have a few high outliers above 4.5. and otherwise symmetrical distributions.</p>
<p><strong>Phase 2 FEV1 vs.&nbsp;Asthma</strong> There appears to be a difference in phase 2 FEV1 scores between patients with and without asthma. The group of patients without asthma (â€œNoâ€ group) has a higher median phase 2 FEV1 score around 2.2, a symmetrical distribution with roughly 7 high outliers above 4.5. The group of patients with asthma (â€œYesâ€ group) has a lower median phase 2 FEV1 score of about 1.75, a smaller range, and more symmetrical distribution than the â€œNoâ€ group, with only 1 outlier at about 4.8.</p>
<p><strong>Phase 2 FEV1 vs.&nbsp;COPD</strong> There appears to be a difference in phase 2 FEV1 scores between patients with and without COPD. The group of patients without COPD, (â€œNoâ€ group) has a median phase 2 FEV1 score of about 2.4, a range of 4.5, and roughly symmetrical distribution other than the high outliers around scores 0f 4.5 to 5. The group of patients with COPD (â€œYesâ€ group) has a lower median phase 2 FEV1 score of about 1.4, a smaller range of about 4, and a slightly more right-skewed distribution.</p>
</section>
<section id="visualize-numeric-variables-by-phase-2-fev1-scores" class="level4">
<h4 class="anchored" data-anchor-id="visualize-numeric-variables-by-phase-2-fev1-scores">Visualize Numeric Variables by Phase 2 FEV1 Scores</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot fev1_phase2 vs. lung volume inspiratory</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> lung_volume_inspiratory , <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 Scores vs. Lung Volume Inspiratory"</span>, <span class="at">x =</span><span class="st">"Lung Volume Inspiratory (Liters)"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot fev1_phase2 vs. lung volume expiratory</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> lung_volume_expiratory_log, <span class="at">y =</span> fev1_phase2))<span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 Scores vs. Lung Volume Expiratory (log transformed)"</span>, <span class="at">x =</span> <span class="st">"Log of Lung Volume Expiratory (Liters)"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot fev1_phase2 vs. duration smoking</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> duration_smoking, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 Scores vs. Duration Smoking"</span>, <span class="at">x =</span> <span class="st">"Duration Smoking (Years)"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot fev1_phase2 vs. average number of cigarettes per day</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> cigs_per_day_avg_log, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 Scores vs. Avg Cigs per Day (log transformed)"</span>, <span class="at">x =</span> <span class="st">"Log Avg Cigs per Day"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot fev1_phase2 vs. Forced Vital Capacity (FVC)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> fvc , <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 Scores vs. FVC"</span>, <span class="at">x =</span> <span class="st">"FVC"</span>, <span class="at">y=</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="COPD_gene_project_files/figure-html/unnamed-chunk-1-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Phase 2 FEV1 vs.&nbsp;Lung Volume Inspiratory</strong> There appears to be a moderate positive linear relationship between lung volume inspiratory and phase 2 FEV1 scores. The most concentrated section of data points is around lung volume inspiratory between 4 and 6 liters and phase 2 FEV1 scores between 1.5 and 3.</p>
<p><strong>Phase 2 FEV1 vs.&nbsp;Log of Lung Volume Expiratory</strong> There does not appear to be much of a relationship between lung volume expiratory and Phase 2 FEV1 scores, possibly a weak negative linear relationship, or a weak nonlinear relationship. The data is clustered around log transformed lung volume expiratory of 1, and phase 2 FEV1 score between 2 and 3.<br>
<br>
<strong>Phase 2 FEV1 vs.&nbsp;Duration Smoking</strong><br>
There appears to be a weak negative linear relationship between duration smoking in years and Phase 2 FEV1 scores. The data is centered around 30-50 years of smoking and phase 2 FEV1 scores between 1.5 and 3.<br>
<br>
<strong>Phase 2 FEV1 vs.&nbsp;Log of Avg Cigs per Day</strong><br>
There does not appear to be any relationship between the average number of cigarettes smoked per day and phase 2 FEV1 scores. There is slightly less variability in phase 2 FEV1 scores for log average cigs per day below 2 and above 4.<br>
<br>
<strong>Phase 2 FEV1 vs.&nbsp;FVC</strong><br>
There appears to be a strong positive linear relationship between FVC and Phase 2 FEV1 scores. The data is most concentrated between FVC of 2 and 4 and phase 2 FEV1 scores between 1.5 and 3.</p>
</section>
</section>
<section id="inference-and-modeling" class="level2">
<h2 class="anchored" data-anchor-id="inference-and-modeling">Inference and Modeling</h2>
<section id="categorical-variables" class="level4">
<h4 class="anchored" data-anchor-id="categorical-variables">Categorical Variables</h4>
<p>Conduct a statistical test to determine if there is a significant difference in <code>fev1_phase2</code> between groups from categorical variables previously visualized.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To determine if there is significant difference in fev1_phase2 scores between groups, I will use bootstrapping to create confidence intervals</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#B = number of bootstrapped samples, n = sample size</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(COPD_data_clean<span class="sc">$</span>fev1_phase2)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">#vectors to store mean differences</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>gender_diffs  <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>smoking_diffs <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>hayfev_diffs  <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>asthma_diffs  <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>copd_diffs    <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co"># create B = 1000 samples</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create random sample of dataset with replacement</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  boot_indexes <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> COPD_data_clean[boot_indexes, ]</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#subset sample by groups and phase2_fev1 scores</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  females       <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"Female"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  males         <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"Male"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  curr_smokers  <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>smoking_status <span class="sc">==</span> <span class="st">"Current Smoker"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  form_smokers  <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>smoking_status <span class="sc">==</span> <span class="st">"Former Smoker"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  hay_fever_yes <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>hay_fever <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  hay_fever_no  <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>hay_fever <span class="sc">==</span> <span class="st">"No"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  asthma_yes    <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>asthma <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  asthma_no     <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>asthma <span class="sc">==</span> <span class="st">"No"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  copd_yes      <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>copd <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>  copd_no       <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>copd <span class="sc">==</span> <span class="st">"No"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calculate and store mean differences for each group</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>  gender_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(females) <span class="sc">-</span> <span class="fu">mean</span>(males)</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>    gender_diffs[i] <span class="ot">&lt;-</span> gender_diff</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>  smoking_status_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(curr_smokers) <span class="sc">-</span> <span class="fu">mean</span>(form_smokers)</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>    smoking_diffs[i] <span class="ot">&lt;-</span> smoking_status_diff</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>  hay_fever_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(hay_fever_no) <span class="sc">-</span> <span class="fu">mean</span>(hay_fever_yes)</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>    hayfev_diffs[i] <span class="ot">&lt;-</span>  hay_fever_diff</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>  asthma_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(asthma_no) <span class="sc">-</span> <span class="fu">mean</span>(asthma_yes)</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>    asthma_diffs[i] <span class="ot">&lt;-</span>  asthma_diff</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>  copd_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(copd_no) <span class="sc">-</span> <span class="fu">mean</span>(copd_yes)</span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>    copd_diffs[i] <span class="ot">&lt;-</span> copd_diff</span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Mean Difference in phase 2 FEV1 by Gender:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Confidence Interval for Mean Difference in phase 2 FEV1 by Gender:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(gender_diffs, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      2.5%      97.5% 
-0.6858250 -0.5619584 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Mean Difference in phase 2 FEV1 by Smoking Status:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Confidence Interval for Mean Difference in phase 2 FEV1 by Smoking Status:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(smoking_diffs, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      2.5%      97.5% 
0.09393503 0.21679733 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Mean Difference in phase 2 FEV1 by Hay Fever:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Confidence Interval for Mean Difference in phase 2 FEV1 by Hay Fever:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(hayfev_diffs, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       2.5%       97.5% 
-0.03994409  0.10265393 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Mean Difference in phase 2 FEV1 by Asthma:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Confidence Interval for Mean Difference in phase 2 FEV1 by Asthma:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(asthma_diffs, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
0.4190685 0.5768384 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Mean Difference in phase 2 FEV1 by COPD:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Confidence Interval for Mean Difference in phase 2 FEV1 by COPD:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(copd_diffs, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
0.9200614 1.0450753 </code></pre>
</div>
</div>
<p>Based on the bootstrapped confidence intervals I created, I can conclude that:</p>
<ul>
<li><p>females have significantly lower phase 2 FEV1 scores than males</p></li>
<li><p>current smokers have significantly greater phase 2 fev1 scores than former smokers</p></li>
<li><p>there is no significant difference in phase 2 FEV1 scores for patients with hay fever and patients who do not have hay fever (0 is contained within the interval)</p></li>
<li><p>patients without asthma have significantly greater phase 2 fev1 scores than patients with asthma</p></li>
<li><p>patients without COPD have signifcantly greater phase 2 fev1 scores than patients with asthma</p></li>
</ul>
</section>
<section id="numeric-variables" class="level4">
<h4 class="anchored" data-anchor-id="numeric-variables">Numeric Variables</h4>
<ol type="1">
<li><p>Fit 5 simple linear regressions using the five numeric variables previously visualized</p></li>
<li><p>Conduct a statistical test to determine if the five slopes from regressions are significantly different from 0</p></li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. fit linear regressions</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>fit_lung_insp <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> lung_volume_inspiratory, <span class="at">data =</span> COPD_data_clean)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>fit_lung_exp_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> lung_volume_expiratory_log, <span class="at">data =</span> COPD_data_clean)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>fit_smoking <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> duration_smoking, <span class="at">data =</span> COPD_data_clean)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>fit_cigs <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> cigs_per_day_avg_log, <span class="at">data =</span> COPD_data_clean)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>fit_FVC <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> fvc, <span class="at">data =</span> COPD_data_clean)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print original fitted linear models</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"phase2_fev1 ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_lung_insp)[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"+"</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_lung_insp)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"(lung_volume_inspiratory)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "phase2_fev1 = 1.254 + 0.165 (lung_volume_inspiratory)"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"phase2_fev1 ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_lung_exp_log)[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"+"</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_lung_exp_log)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"(lung_volume_expiratory_log)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "phase2_fev1 = 2.554 + -0.343 (lung_volume_expiratory_log)"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"phase2_fev1 ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_smoking)[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"+"</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_smoking)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"(duration_smoking)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "phase2_fev1 = 2.98 + -0.023 (duration_smoking)"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"phase2_fev1 ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_cigs)[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"+"</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_cigs)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"(cigs_per_day_avg_log)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "phase2_fev1 = 2.4 + -0.072 (cigs_per_day_avg_log)"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"phase2_fev1 ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_FVC)[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"+"</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_FVC)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"(fvc)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "phase2_fev1 = -0.073 + 0.658 (fvc)"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"----"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "----"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># To determine if the slopes from the linear models above are different from zero, I will use bootstrapping to create confidence intervals</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">2000</span> <span class="co"># number of bootstrapped samples</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(COPD_data_clean<span class="sc">$</span>fev1_phase2) <span class="co">#sample szie</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co">#vectors to store slopes</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>lung_in_slopes  <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>lung_exp_slopes <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>smoking_slopes  <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>cigs_slopes     <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>fvc_slopes      <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co">#loop</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#create random sample with replacement</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  boot_indexes <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(COPD_data_clean), <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> COPD_data_clean[boot_indexes, ]</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fit linear models</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  boot_fit_lung_insp <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> lung_volume_inspiratory, <span class="at">data =</span> boot_sample)</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  boot_fit_lung_exp_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> lung_volume_expiratory_log, <span class="at">data =</span> boot_sample)</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  boot_fit_smoking <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> duration_smoking, <span class="at">data =</span> boot_sample)</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  boot_fit_cigs <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> cigs_per_day_avg_log, <span class="at">data =</span> boot_sample)</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>  boot_fit_FVC <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> fvc, <span class="at">data =</span> boot_sample)</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#store slopes</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>    lung_in_slopes[i] <span class="ot">&lt;-</span> <span class="fu">coef</span>(boot_fit_lung_insp)[<span class="dv">2</span>]</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>    lung_exp_slopes[i] <span class="ot">&lt;-</span> <span class="fu">coef</span>(boot_fit_lung_exp_log)[<span class="dv">2</span>]</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>    smoking_slopes[i] <span class="ot">&lt;-</span>  <span class="fu">coef</span>(boot_fit_smoking)[<span class="dv">2</span>]</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>    cigs_slopes[i]     <span class="ot">&lt;-</span>  <span class="fu">coef</span>(boot_fit_cigs)[<span class="dv">2</span>]</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>    fvc_slopes [i]     <span class="ot">&lt;-</span>  <span class="fu">coef</span>(boot_fit_FVC)[<span class="dv">2</span>]</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create and print confidence intervals for slopes</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% confidence interval for slope of linear regression on phase 2 FEV1 w.r.t. lung_volume_inspiratory"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% confidence interval for slope of linear regression on phase 2 FEV1 w.r.t. lung_volume_inspiratory"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(lung_in_slopes, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
0.1403528 0.1917183 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% confidence interval for slope of linear regressionon phase 2 FEV1 w.r.t. lung_volume_expiratory_log"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% confidence interval for slope of linear regressionon phase 2 FEV1 w.r.t. lung_volume_expiratory_log"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(lung_exp_slopes, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      2.5%      97.5% 
-0.4510490 -0.2334882 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% confidence interval for slope of linear regression on phase 2 FEV1 w.r.t. duration_smoking"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% confidence interval for slope of linear regression on phase 2 FEV1 w.r.t. duration_smoking"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(smoking_slopes, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       2.5%       97.5% 
-0.02578283 -0.02019329 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% confidence interval for slope of linear regression on phase 2 FEV1 w.r.t. cigs_per_day_avg_log"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% confidence interval for slope of linear regression on phase 2 FEV1 w.r.t. cigs_per_day_avg_log"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(cigs_slopes, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        2.5%        97.5% 
-0.141752143 -0.002762196 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% confidence interval for slope of linear regression on phase 2 FEV1 w.r.t. fvc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% confidence interval for slope of linear regression on phase 2 FEV1 w.r.t. fvc"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(fvc_slopes, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
0.6338739 0.6818313 </code></pre>
</div>
</div>
<p>Based on my linear regression models, and the bootstrapped 95% confidence intervals for the slopes of the regression models, I can conclude that,</p>
<ul>
<li><p>lung volume inspiratory and phase 2 FEV1 are significantly correlated (the slope is significantly greater than 0) because 0 is not contained in the confidence interval</p></li>
<li><p>lung volume expiratory (log transformed) and phase 2 FEV1 are significantly correlated (slope is significantly less than 0) because 0 is not contained within the interval</p></li>
<li><p>duration smoking and phase 2 fev1 score are significantly correlated (slope is significantly less than 0) because 0 is not contained within the interval</p></li>
<li><p>average number of cigarettes per day (log transformed) and phase 2 fev1 score are significantly correlated (slope is significantly less than 0) because 0 is not contained within the interval</p></li>
<li><p>FVC and phase 2 fev1 score are significantly correlated (slope is significantly greater than 0) because 0 is not contained within the interval</p></li>
</ul>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Affecting over 16 million Americans, chronic obstructive pulmonary disease (COPD) is commonly caused by cigarette smoking, asthma, and toxin inhalation. There is no cure for COPD; however, patients receive care to manage symptoms and slow the progression of the disease. One way to measure the severity of COPD is through spirometry. One spirometry measure is the forced expiratory volume (FEV1), which measures the volume of air forcefully exhaled in 1 second. The aim of this study was to compare patientsâ€™ FEV1 scores at the five year follow up (denoted as â€œphase 2â€), to other variables from the patient data.</p>
<p>The data used came from the COPDGene Research Group. It included separate datasets of demographic, spirometry and medical image data for 2620 patients. The datasets were merged together by patient id. The data was cleaned to remove missing values, and convert variables into more usable data types. The final dataset was 2600 rows and 41 variables. The variables included information about visit date, patientsâ€™ age, gender, race, smoking status, blood pressure, heart rate, height, weight, and bmi. There were also variables about the patientâ€™s smoking history and any respiratory illness diagnoses. Spirometry variables included lung volume inspiratory and expiratory (the volume of air in lungs at inhalation and exhalation), FEV1, FEV1 at phase 2 (follow up), forced vital capacity (FVC) and fev1_fvc ratio.</p>
<p>Exploratory analysis was performed next. A function was created to return summary statistics for numeric variables, and a frequency table for character variables. The lapply function was utilized to apply the custom function to each column in the dataset. The ggplot2 library was used to create histograms for all numeric and integer variables. After reviewing these histograms, some variables were transformed to be more normally distributed to be used for analysis. The fev1_fvc_ratio was left-skewed, so a square transformation was performed. Lung volume expiratory, emphysema percentage, average cigarettes per day, and smoking start age were all highly right skewed and log transformations were performed on these.</p>
<p>Next, to compare phase 2 FEV1 scores between different groups of patients, ggplot2 was used to create boxplots of categorical variables. The chosen categorical variables were gender, smoking status, hay fever, asthma, and copd diagnosis. The boxplots showed differences between groups for gender, asthma and copd. Scatterplots were created with ggplot2 to look for relationships between numeric variables and phase 2 fev1 scores. Lung volume inspiratory, lung volume expiratory (log-transformed), duration smoking, average number of cigarettes per day (log-transformed) and FVC were graphed as explanatory variables with phase 2 FEV1 as the response. The scatterplots for lung volume inspiratory and FVC showed positive linear relationships, while lung volume expiratory and duration smoking showed negative linear relationships.</p>
<p>Finally, bootstrapping was implemented to test the significance of the relationships seen in the data visualizations that were created. Bootstrapping is a method that involves repeatedly sampling a data sample with replacement. This process simulates the sampling distribution, which allows for statistical inference to be made through confidence intervals. Bootstrapped confidence intervals were created for the mean difference in phase 2 FEV1 scores for each of the categorical variables chosen. These confidence intervals revealed that females have significantly lower phase 2 FEV1 scores than males do, current smokers have significantly greater phase 2 FEV1 scores than former smokers, hay fever diagnosis does not relate to phase 2 fev1 scores, patients without asthma have greater phase 2 fev1 scores than patients with asthma, and patients without copd have greater phase 2 copd scores than patients without copd. The difference in phase 2 FEV1 scores between current and former smokers had a 95% confidence interval of [0.09, 0.21] which are relatively small values compared to the difference of patients with or without COPD, [0.92, 1.04], so even though the differences for smoking status are statistically significant, they may not be clinically significant. For numeric variables, bootstrapped confidence intervals were made for the slopes of a simple linear regression model between each one of the chosen numeric variables and phase 2 FEV1 scores. As expected based on the scatterplots, the confidence intervals showed lung volume inspiratory and FVC had slopes significantly greater than zero, indicating positive linear relationships, and lung volume expiratory, duration smoking, and average cigarettes per day had slopes significantly less than zero, indicating negative linear relationships with phase 2 FEV1. Overall, many variables, categorical and quantitative, have significant relationships with phase 2 fev1 scores, so more analysis is needed to determine which variables are the most significant.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/jsnyder82\.github\.io\/portfolio-website\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb90" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "COPD Gene Study - Final Class Project"</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Analyze relationship between variables and Phase 2 FEV1 Scores"</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co">    class: project-page</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2025-05-08</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [R, Epidemiology, Data Visualization]</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="fu">### Authors</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>This project was written by Dr. Kyle Hasenstab as the final project for an introductory data science class taught in R at SDSU. It was completed by Jayna Snyder. Formatting has been edited for display on portfolio.</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>Chronic obstructive pulmonary disease (COPD) affects over 16 million Americans and is the fourth leading cause of death in the United States behind heart disease, cancer, and accidental death. While COPD can result from various toxic inhalations or asthma, it is most commonly associated with cigarette smoking.</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>COPD severity is typically measured by a device called a spirometer. Patients forcefully exhale into the device and the volume of air exhaled is used as a measure for the severity of disease (less air exhaled $\Rightarrow$ worse disease). Data collected by the COPDGene research group includes spirometry data on thousands of research participants.</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>Spirometry measures in the dataset:</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The forced expiratory volume (FEV1) is the volume of air exhaled in 1 second <span class="sc">\*</span> The forced vital capacity (FVC) is the total volume of air exhaled after a full breath</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>FEV1_FVC_ratio is the ratio between FEV1 and FVC (smaller $\Rightarrow$ worse disease)</span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>FEV1_phase2 is the FEV1 of research participants 5 years later</span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>The overall task in this project is to analyze the relationship between FEV1 at follow-up (FEV1_phase2) and other variables in the dataset. The project has been organized into a series of tasks to assist with analysis organization.</span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Wrangling</span></span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a><span class="in">```{r libraries}</span></span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a><span class="co">#necessary packages &amp; libraries</span></span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb90-38"><a href="#cb90-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-39"><a href="#cb90-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-40"><a href="#cb90-40" aria-hidden="true" tabindex="-1"></a>**Import Data**</span>
<span id="cb90-41"><a href="#cb90-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-42"><a href="#cb90-42" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load datasets}</span></span>
<span id="cb90-43"><a href="#cb90-43" aria-hidden="true" tabindex="-1"></a><span class="co">#import COPD demographics data from CSV file</span></span>
<span id="cb90-44"><a href="#cb90-44" aria-hidden="true" tabindex="-1"></a>COPD_demographics <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/khasenst/datasets_teaching/refs/heads/main/copd_data_demographics.csv"</span>)</span>
<span id="cb90-45"><a href="#cb90-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>(COPD_demographics)</span>
<span id="cb90-46"><a href="#cb90-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-47"><a href="#cb90-47" aria-hidden="true" tabindex="-1"></a><span class="co">#import COPD medical images data from JSON file</span></span>
<span id="cb90-48"><a href="#cb90-48" aria-hidden="true" tabindex="-1"></a>COPD_medical_images <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"https://raw.githubusercontent.com/khasenst/datasets_teaching/refs/heads/main/copd_data_imaging.json"</span>)</span>
<span id="cb90-49"><a href="#cb90-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>(COPD_medical_images)</span>
<span id="cb90-50"><a href="#cb90-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-51"><a href="#cb90-51" aria-hidden="true" tabindex="-1"></a><span class="co">#import COPD spirometry data from HTML file</span></span>
<span id="cb90-52"><a href="#cb90-52" aria-hidden="true" tabindex="-1"></a>html <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">"https://raw.githubusercontent.com/khasenst/datasets_teaching/refs/heads/main/copd_data_spirometry.html"</span>)</span>
<span id="cb90-53"><a href="#cb90-53" aria-hidden="true" tabindex="-1"></a>COPD_spirometry <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">html_table</span>(html)[[<span class="dv">1</span>]])</span>
<span id="cb90-54"><a href="#cb90-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>(COPD_spirometry)</span>
<span id="cb90-55"><a href="#cb90-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-56"><a href="#cb90-56" aria-hidden="true" tabindex="-1"></a><span class="co">#import data dictionary</span></span>
<span id="cb90-57"><a href="#cb90-57" aria-hidden="true" tabindex="-1"></a>COPD_data_dictionary <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/khasenst/datasets_teaching/refs/heads/main/copd_data_dictionary.csv"</span>)</span>
<span id="cb90-58"><a href="#cb90-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-59"><a href="#cb90-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-60"><a href="#cb90-60" aria-hidden="true" tabindex="-1"></a>**Merge Data Sets**</span>
<span id="cb90-61"><a href="#cb90-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-62"><a href="#cb90-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge datasets}</span></span>
<span id="cb90-63"><a href="#cb90-63" aria-hidden="true" tabindex="-1"></a><span class="co"># merge demographics and medical images dataset</span></span>
<span id="cb90-64"><a href="#cb90-64" aria-hidden="true" tabindex="-1"></a>COPD_data <span class="ot">&lt;-</span> <span class="fu">merge</span>( <span class="at">x =</span> COPD_demographics,</span>
<span id="cb90-65"><a href="#cb90-65" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> COPD_medical_images,</span>
<span id="cb90-66"><a href="#cb90-66" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by.x =</span> <span class="st">"sid"</span>,</span>
<span id="cb90-67"><a href="#cb90-67" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by.y =</span> <span class="st">"sid"</span>,</span>
<span id="cb90-68"><a href="#cb90-68" aria-hidden="true" tabindex="-1"></a>                    <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb90-69"><a href="#cb90-69" aria-hidden="true" tabindex="-1"></a>                    <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-70"><a href="#cb90-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-71"><a href="#cb90-71" aria-hidden="true" tabindex="-1"></a><span class="co"># merge demographics, medical images, and spirometry datasets</span></span>
<span id="cb90-72"><a href="#cb90-72" aria-hidden="true" tabindex="-1"></a>COPD_data <span class="ot">&lt;-</span> <span class="fu">merge</span>( <span class="at">x =</span> COPD_data,</span>
<span id="cb90-73"><a href="#cb90-73" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> COPD_spirometry,</span>
<span id="cb90-74"><a href="#cb90-74" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by.x =</span> <span class="st">"sid"</span>,</span>
<span id="cb90-75"><a href="#cb90-75" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by.y =</span> <span class="st">"sid"</span>,</span>
<span id="cb90-76"><a href="#cb90-76" aria-hidden="true" tabindex="-1"></a>                    <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb90-77"><a href="#cb90-77" aria-hidden="true" tabindex="-1"></a>                    <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-78"><a href="#cb90-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-79"><a href="#cb90-79" aria-hidden="true" tabindex="-1"></a><span class="co"># check dimensions of new data set</span></span>
<span id="cb90-80"><a href="#cb90-80" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(COPD_data)</span>
<span id="cb90-81"><a href="#cb90-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-82"><a href="#cb90-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-83"><a href="#cb90-83" aria-hidden="true" tabindex="-1"></a>**Variable Manipulation**</span>
<span id="cb90-84"><a href="#cb90-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-85"><a href="#cb90-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r variable manipulation}</span></span>
<span id="cb90-86"><a href="#cb90-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert numeric indicator variables into factor type with descriptive labels from data dictionary</span></span>
<span id="cb90-87"><a href="#cb90-87" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(COPD_data<span class="sc">$</span>gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>))</span>
<span id="cb90-88"><a href="#cb90-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-89"><a href="#cb90-89" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>race <span class="ot">&lt;-</span> <span class="fu">factor</span>(COPD_data<span class="sc">$</span>race, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"White"</span>, <span class="st">"Black"</span>))</span>
<span id="cb90-90"><a href="#cb90-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-91"><a href="#cb90-91" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>smoking_status <span class="ot">&lt;-</span> <span class="fu">factor</span>(COPD_data<span class="sc">$</span>smoking_status, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Never Smoked"</span>, <span class="st">"Former Smoker"</span>, <span class="st">"Current Smoker"</span>))</span>
<span id="cb90-92"><a href="#cb90-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-93"><a href="#cb90-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new height variable in inches</span></span>
<span id="cb90-94"><a href="#cb90-94" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>height_in <span class="ot">&lt;-</span> COPD_data<span class="sc">$</span>height_cm <span class="sc">/</span> <span class="fl">2.54</span></span>
<span id="cb90-95"><a href="#cb90-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-96"><a href="#cb90-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new weight variable in pounds</span></span>
<span id="cb90-97"><a href="#cb90-97" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>weight_lbs <span class="ot">&lt;-</span> COPD_data<span class="sc">$</span>weight_kg <span class="sc">*</span> <span class="fl">2.2</span></span>
<span id="cb90-98"><a href="#cb90-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-99"><a href="#cb90-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to date</span></span>
<span id="cb90-100"><a href="#cb90-100" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>visit_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(COPD_data<span class="sc">$</span>visit_date, <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)</span>
<span id="cb90-101"><a href="#cb90-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-102"><a href="#cb90-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert age to integer</span></span>
<span id="cb90-103"><a href="#cb90-103" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>visit_age <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(COPD_data<span class="sc">$</span>visit_age)</span>
<span id="cb90-104"><a href="#cb90-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-105"><a href="#cb90-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert visit year to factor</span></span>
<span id="cb90-106"><a href="#cb90-106" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>visit_year <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(COPD_data<span class="sc">$</span>visit_year)</span>
<span id="cb90-107"><a href="#cb90-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-108"><a href="#cb90-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert hours_on_oxygen to factor because there are only discrete options (1, 2, ..., 24 hours)</span></span>
<span id="cb90-109"><a href="#cb90-109" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>hours_on_oxygen <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(COPD_data<span class="sc">$</span>hours_on_oxygen)</span>
<span id="cb90-110"><a href="#cb90-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-111"><a href="#cb90-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Check work</span></span>
<span id="cb90-112"><a href="#cb90-112" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(COPD_data)</span>
<span id="cb90-113"><a href="#cb90-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-114"><a href="#cb90-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-115"><a href="#cb90-115" aria-hidden="true" tabindex="-1"></a>**Text Processing for Variable Creation**</span>
<span id="cb90-116"><a href="#cb90-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-117"><a href="#cb90-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r text processing for variable creation}</span></span>
<span id="cb90-118"><a href="#cb90-118" aria-hidden="true" tabindex="-1"></a><span class="co"># Use text processing to convert respiratory variable into separate variables by diagnosis</span></span>
<span id="cb90-119"><a href="#cb90-119" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>hay_fever          <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"hay fever"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb90-120"><a href="#cb90-120" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>asthma             <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"asthma"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb90-121"><a href="#cb90-121" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>bronchitis_attacks <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"bronchitis attacks"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb90-122"><a href="#cb90-122" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>chronic_bronchitis <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"chronic bronchitis"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb90-123"><a href="#cb90-123" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>pneumonia          <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"pneumonia"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb90-124"><a href="#cb90-124" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>emphysema          <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"emphysema"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb90-125"><a href="#cb90-125" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>copd               <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"copd"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb90-126"><a href="#cb90-126" aria-hidden="true" tabindex="-1"></a>COPD_data<span class="sc">$</span>sleep_apnea        <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="at">pattern =</span> <span class="st">"sleep apnea"</span>, <span class="at">x =</span> COPD_data<span class="sc">$</span>respiratory) , <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb90-127"><a href="#cb90-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-128"><a href="#cb90-128" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(COPD_data[, <span class="fu">c</span>(<span class="st">"hay_fever"</span>, <span class="st">"asthma"</span>, <span class="st">"bronchitis_attacks"</span>, <span class="st">"chronic_bronchitis"</span>, <span class="st">"pneumonia"</span>, <span class="st">"emphysema"</span>, <span class="st">"copd"</span>, <span class="st">"sleep_apnea"</span>)])</span>
<span id="cb90-129"><a href="#cb90-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-130"><a href="#cb90-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-131"><a href="#cb90-131" aria-hidden="true" tabindex="-1"></a>**Removing Unnecessary Variables**</span>
<span id="cb90-132"><a href="#cb90-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-133"><a href="#cb90-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r remove unwanted columns}</span></span>
<span id="cb90-134"><a href="#cb90-134" aria-hidden="true" tabindex="-1"></a><span class="co"># create new data set without height_cm, weight_kg, and respiratory columns</span></span>
<span id="cb90-135"><a href="#cb90-135" aria-hidden="true" tabindex="-1"></a>COPD_data_clean <span class="ot">&lt;-</span> COPD_data[ , <span class="sc">!</span><span class="fu">names</span>(COPD_data) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"height_cm"</span>, <span class="st">"weight_kg"</span>, <span class="st">"respiratory"</span>)]</span>
<span id="cb90-136"><a href="#cb90-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-137"><a href="#cb90-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-138"><a href="#cb90-138" aria-hidden="true" tabindex="-1"></a>**Export new dataset**</span>
<span id="cb90-139"><a href="#cb90-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-140"><a href="#cb90-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r export new data set}</span></span>
<span id="cb90-141"><a href="#cb90-141" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb90-142"><a href="#cb90-142" aria-hidden="true" tabindex="-1"></a><span class="co">#Export data as csv file</span></span>
<span id="cb90-143"><a href="#cb90-143" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="at">x =</span> COPD_data_clean, <span class="at">file =</span> <span class="st">"copd_data.csv"</span>)</span>
<span id="cb90-144"><a href="#cb90-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-145"><a href="#cb90-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-146"><a href="#cb90-146" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Statistics and Exploratory Analysis</span></span>
<span id="cb90-147"><a href="#cb90-147" aria-hidden="true" tabindex="-1"></a>**Function for descriptive statistics**</span>
<span id="cb90-148"><a href="#cb90-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-149"><a href="#cb90-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r function for descriptive stats}</span></span>
<span id="cb90-150"><a href="#cb90-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-151"><a href="#cb90-151" aria-hidden="true" tabindex="-1"></a><span class="co">#function that returns descriptive statistics for variable in data frame</span></span>
<span id="cb90-152"><a href="#cb90-152" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="cf">function</span>(var) {</span>
<span id="cb90-153"><a href="#cb90-153" aria-hidden="true" tabindex="-1"></a>  <span class="co">#returns mean and standard deviation for numeric and integer columns</span></span>
<span id="cb90-154"><a href="#cb90-154" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">class</span>(var) <span class="sc">==</span> <span class="st">"numeric"</span> <span class="sc">|</span> <span class="fu">class</span>(var) <span class="sc">==</span> <span class="st">"integer"</span>){</span>
<span id="cb90-155"><a href="#cb90-155" aria-hidden="true" tabindex="-1"></a>    mean_var <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(var), <span class="dv">3</span>)</span>
<span id="cb90-156"><a href="#cb90-156" aria-hidden="true" tabindex="-1"></a>    sd_var <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sd</span>(var), <span class="dv">3</span>)</span>
<span id="cb90-157"><a href="#cb90-157" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mean =</span> mean_var, <span class="at">sd =</span> sd_var))</span>
<span id="cb90-158"><a href="#cb90-158" aria-hidden="true" tabindex="-1"></a>  <span class="co">#returns a frequency table for character or factor columns</span></span>
<span id="cb90-159"><a href="#cb90-159" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb90-160"><a href="#cb90-160" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">table</span>(var))</span>
<span id="cb90-161"><a href="#cb90-161" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb90-162"><a href="#cb90-162" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-163"><a href="#cb90-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-164"><a href="#cb90-164" aria-hidden="true" tabindex="-1"></a><span class="co"># test function on categorical variable</span></span>
<span id="cb90-165"><a href="#cb90-165" aria-hidden="true" tabindex="-1"></a><span class="fu">stats</span>(COPD_data_clean<span class="sc">$</span>asthma)</span>
<span id="cb90-166"><a href="#cb90-166" aria-hidden="true" tabindex="-1"></a><span class="co"># test function on numeric variable</span></span>
<span id="cb90-167"><a href="#cb90-167" aria-hidden="true" tabindex="-1"></a><span class="fu">stats</span>(COPD_data_clean<span class="sc">$</span>bmi)</span>
<span id="cb90-168"><a href="#cb90-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-169"><a href="#cb90-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-170"><a href="#cb90-170" aria-hidden="true" tabindex="-1"></a>**Apply the function to all columns**</span>
<span id="cb90-171"><a href="#cb90-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-172"><a href="#cb90-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r apply function to all columns}</span></span>
<span id="cb90-173"><a href="#cb90-173" aria-hidden="true" tabindex="-1"></a><span class="co"># apply function across columns except id column</span></span>
<span id="cb90-174"><a href="#cb90-174" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="at">X =</span> COPD_data_clean[, <span class="fu">names</span>(COPD_data_clean) <span class="sc">!=</span> <span class="st">"sid"</span>], </span>
<span id="cb90-175"><a href="#cb90-175" aria-hidden="true" tabindex="-1"></a>       <span class="at">FUN =</span> stats)</span>
<span id="cb90-176"><a href="#cb90-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-177"><a href="#cb90-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-178"><a href="#cb90-178" aria-hidden="true" tabindex="-1"></a>I noticed that the following variables all report NA, so missing values need to be excluded for these variables:</span>
<span id="cb90-179"><a href="#cb90-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-180"><a href="#cb90-180" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>lung_volume_inspiartory</span>
<span id="cb90-181"><a href="#cb90-181" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>emphysema_percentage</span>
<span id="cb90-182"><a href="#cb90-182" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>lung_volume_expiratory</span>
<span id="cb90-183"><a href="#cb90-183" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>gas_trapping_percentage</span>
<span id="cb90-184"><a href="#cb90-184" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>mean_density_inspiratory</span>
<span id="cb90-185"><a href="#cb90-185" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>mean_density_expiratory</span>
<span id="cb90-186"><a href="#cb90-186" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>fev1_fvc_ratio</span>
<span id="cb90-187"><a href="#cb90-187" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>fev1</span>
<span id="cb90-188"><a href="#cb90-188" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>fvc</span>
<span id="cb90-189"><a href="#cb90-189" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>fev1_phase2</span>
<span id="cb90-190"><a href="#cb90-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-191"><a href="#cb90-191" aria-hidden="true" tabindex="-1"></a>**Remove missing values and rerun descriptive statistics**</span>
<span id="cb90-192"><a href="#cb90-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-193"><a href="#cb90-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r remove missing values}</span></span>
<span id="cb90-194"><a href="#cb90-194" aria-hidden="true" tabindex="-1"></a><span class="co">#remove rows with missing values, complete.cases returns true for each row that contains values in all columns</span></span>
<span id="cb90-195"><a href="#cb90-195" aria-hidden="true" tabindex="-1"></a>COPD_data_clean <span class="ot">&lt;-</span> COPD_data_clean[ <span class="fu">complete.cases</span>(COPD_data_clean) , ]</span>
<span id="cb90-196"><a href="#cb90-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-197"><a href="#cb90-197" aria-hidden="true" tabindex="-1"></a><span class="co">#check stats now return values instead of NA</span></span>
<span id="cb90-198"><a href="#cb90-198" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(COPD_data_clean[ , <span class="fu">names</span>(COPD_data_clean) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"lung_volume_inspiratory"</span>, <span class="st">"emphysema_percentage"</span>,</span>
<span id="cb90-199"><a href="#cb90-199" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lung_volume_expiratory"</span>, <span class="st">"gas_trapping_percentage"</span>, <span class="st">"mean_density_inspiratory"</span>, <span class="st">"mean_density_expiratory"</span>,</span>
<span id="cb90-200"><a href="#cb90-200" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fev1_fvc_ratio"</span>, <span class="st">"fev1"</span>, <span class="st">"fvc"</span>, <span class="st">"fev1_phase2"</span> ) ], stats)</span>
<span id="cb90-201"><a href="#cb90-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-202"><a href="#cb90-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-203"><a href="#cb90-203" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualizing numeric variables with histograms</span></span>
<span id="cb90-204"><a href="#cb90-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-205"><a href="#cb90-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r histograms for numeric variables}</span></span>
<span id="cb90-206"><a href="#cb90-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-207"><a href="#cb90-207" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">names</span>(COPD_data_clean)) {</span>
<span id="cb90-208"><a href="#cb90-208" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">is.numeric</span>(COPD_data_clean[,col]) <span class="sc">|</span> <span class="fu">is.integer</span>(COPD_data_clean[,col])){</span>
<span id="cb90-209"><a href="#cb90-209" aria-hidden="true" tabindex="-1"></a>   plot <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> .data[[col]])) <span class="sc">+</span></span>
<span id="cb90-210"><a href="#cb90-210" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">bins =</span> <span class="dv">30</span> ) <span class="sc">+</span></span>
<span id="cb90-211"><a href="#cb90-211" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Frequency of"</span>, col)) <span class="sc">+</span> </span>
<span id="cb90-212"><a href="#cb90-212" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_light</span>()</span>
<span id="cb90-213"><a href="#cb90-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-214"><a href="#cb90-214" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(plot)</span>
<span id="cb90-215"><a href="#cb90-215" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb90-216"><a href="#cb90-216" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-217"><a href="#cb90-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-218"><a href="#cb90-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-219"><a href="#cb90-219" aria-hidden="true" tabindex="-1"></a>The following variables are highly skewed:</span>
<span id="cb90-220"><a href="#cb90-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-221"><a href="#cb90-221" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>fev1_fvc_ratio (left-skewed)</span>
<span id="cb90-222"><a href="#cb90-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-223"><a href="#cb90-223" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>gas_trapping_percentage (right-skewed)</span>
<span id="cb90-224"><a href="#cb90-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-225"><a href="#cb90-225" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>lung_volume_expiratory (right-skewed)</span>
<span id="cb90-226"><a href="#cb90-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-227"><a href="#cb90-227" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>emphysema_percentage (right-skewed)</span>
<span id="cb90-228"><a href="#cb90-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-229"><a href="#cb90-229" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>cigs_per_day_avg (right-skewed)</span>
<span id="cb90-230"><a href="#cb90-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-231"><a href="#cb90-231" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>hours_on_oxygen (right-skewed)</span>
<span id="cb90-232"><a href="#cb90-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-233"><a href="#cb90-233" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>smoke_start_age (right-skewed)</span>
<span id="cb90-234"><a href="#cb90-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-235"><a href="#cb90-235" aria-hidden="true" tabindex="-1"></a>I decided the best transformation for each variable by plotting histograms of the transformed variables to see which transformation created the most normal shaped (least skewed) distribution.</span>
<span id="cb90-236"><a href="#cb90-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-237"><a href="#cb90-237" aria-hidden="true" tabindex="-1"></a>**Transform Variables and Recreate Histograms**</span>
<span id="cb90-238"><a href="#cb90-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-239"><a href="#cb90-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r transform skewed variables}</span></span>
<span id="cb90-240"><a href="#cb90-240" aria-hidden="true" tabindex="-1"></a><span class="co">#transform skewed variables</span></span>
<span id="cb90-241"><a href="#cb90-241" aria-hidden="true" tabindex="-1"></a>COPD_data_clean<span class="sc">$</span>fev1_fvc_ratio_squared <span class="ot">&lt;-</span> (COPD_data_clean<span class="sc">$</span>fev1_fvc_ratio)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb90-242"><a href="#cb90-242" aria-hidden="true" tabindex="-1"></a>COPD_data_clean<span class="sc">$</span>gas_trapping_percentage_sqrt <span class="ot">&lt;-</span>  <span class="fu">sqrt</span>(COPD_data_clean<span class="sc">$</span>gas_trapping_percentage)</span>
<span id="cb90-243"><a href="#cb90-243" aria-hidden="true" tabindex="-1"></a>COPD_data_clean<span class="sc">$</span>lung_volume_expiratory_log <span class="ot">&lt;-</span> <span class="fu">log</span>(COPD_data_clean<span class="sc">$</span>lung_volume_expiratory)</span>
<span id="cb90-244"><a href="#cb90-244" aria-hidden="true" tabindex="-1"></a>COPD_data_clean<span class="sc">$</span>emphysema_percentage_log <span class="ot">&lt;-</span> <span class="fu">log</span>(COPD_data_clean<span class="sc">$</span>emphysema_percentage)</span>
<span id="cb90-245"><a href="#cb90-245" aria-hidden="true" tabindex="-1"></a>COPD_data_clean<span class="sc">$</span>cigs_per_day_avg_log <span class="ot">&lt;-</span> <span class="fu">log</span>(COPD_data_clean<span class="sc">$</span>cigs_per_day_avg)</span>
<span id="cb90-246"><a href="#cb90-246" aria-hidden="true" tabindex="-1"></a>COPD_data_clean<span class="sc">$</span>smoke_start_age_log <span class="ot">&lt;-</span> <span class="fu">log</span>(COPD_data_clean<span class="sc">$</span>smoke_start_age)</span>
<span id="cb90-247"><a href="#cb90-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-248"><a href="#cb90-248" aria-hidden="true" tabindex="-1"></a>transformed_vars <span class="ot">&lt;-</span> COPD_data_clean[, <span class="fu">names</span>(COPD_data_clean) <span class="sc">%in%</span></span>
<span id="cb90-249"><a href="#cb90-249" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">c</span>(<span class="st">"fev1_fvc_ratio_squared"</span>,</span>
<span id="cb90-250"><a href="#cb90-250" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"gas_trapping_percentage_sqrt"</span>,</span>
<span id="cb90-251"><a href="#cb90-251" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"lung_volume_expiratory_log"</span>,</span>
<span id="cb90-252"><a href="#cb90-252" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"emphysema_percentage_log"</span>,</span>
<span id="cb90-253"><a href="#cb90-253" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"cigs_per_day_avg_log"</span>,</span>
<span id="cb90-254"><a href="#cb90-254" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"smoke_start_age_log"</span>)]</span>
<span id="cb90-255"><a href="#cb90-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-256"><a href="#cb90-256" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">names</span>(transformed_vars)) {</span>
<span id="cb90-257"><a href="#cb90-257" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">is.numeric</span>(COPD_data_clean[,col]) <span class="sc">|</span> <span class="fu">is.integer</span>(COPD_data_clean[,col])){</span>
<span id="cb90-258"><a href="#cb90-258" aria-hidden="true" tabindex="-1"></a>   plot <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> .data[[col]])) <span class="sc">+</span></span>
<span id="cb90-259"><a href="#cb90-259" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb90-260"><a href="#cb90-260" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Frequency of"</span>, col)) <span class="sc">+</span> </span>
<span id="cb90-261"><a href="#cb90-261" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_light</span>()</span>
<span id="cb90-262"><a href="#cb90-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-263"><a href="#cb90-263" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(plot)</span>
<span id="cb90-264"><a href="#cb90-264" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb90-265"><a href="#cb90-265" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-266"><a href="#cb90-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-267"><a href="#cb90-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-268"><a href="#cb90-268" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize Categorical Variables by Phase 2 FEV1 Scores</span></span>
<span id="cb90-269"><a href="#cb90-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-270"><a href="#cb90-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r visualize categorical vars by phase 2 FEV1}</span></span>
<span id="cb90-271"><a href="#cb90-271" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing Phase 2 FEV1 scores by categorical variables</span></span>
<span id="cb90-272"><a href="#cb90-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-273"><a href="#cb90-273" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb90-274"><a href="#cb90-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb90-275"><a href="#cb90-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 vs. Gender"</span>, <span class="at">x =</span> <span class="st">"Gender"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb90-276"><a href="#cb90-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb90-277"><a href="#cb90-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-278"><a href="#cb90-278" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> smoking_status, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb90-279"><a href="#cb90-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb90-280"><a href="#cb90-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 vs. Smoking Status"</span>, <span class="at">x =</span> <span class="st">"Smoking Status"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb90-281"><a href="#cb90-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb90-282"><a href="#cb90-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-283"><a href="#cb90-283" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> hay_fever, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb90-284"><a href="#cb90-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb90-285"><a href="#cb90-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 vs. Hay Fever"</span>, <span class="at">x =</span> <span class="st">"Hay Fever"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb90-286"><a href="#cb90-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb90-287"><a href="#cb90-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-288"><a href="#cb90-288" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> asthma, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb90-289"><a href="#cb90-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb90-290"><a href="#cb90-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 vs. Asthma"</span>, <span class="at">x =</span> <span class="st">"Asthma"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb90-291"><a href="#cb90-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb90-292"><a href="#cb90-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-293"><a href="#cb90-293" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> copd, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb90-294"><a href="#cb90-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb90-295"><a href="#cb90-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 Score vs. COPD"</span>, <span class="at">x =</span> <span class="st">"COPD"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1 Score"</span>) <span class="sc">+</span> </span>
<span id="cb90-296"><a href="#cb90-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb90-297"><a href="#cb90-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-298"><a href="#cb90-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-299"><a href="#cb90-299" aria-hidden="true" tabindex="-1"></a>**Phase 2 FEV1 vs. Gender** There does appear to be a difference in phase 2 FEV1 score in females versus males. For females, the median phase2_fev1 is just under 2, with maximum scores up to about 3.5. For males, the median phase2_fev1 score is higher, just above 2.5, with maximum scores up to about 5. Male phase2_fev1 scores have higher variability than that for females. Neither group has outliers, and both groups have symmetrical distributions.</span>
<span id="cb90-300"><a href="#cb90-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-301"><a href="#cb90-301" aria-hidden="true" tabindex="-1"></a>**Phase 2 FEV1 vs. Smoking Status** There does not appear to be a difference in phase 2 FEV1 scores between former smokers and current smokers. Both groups have median phase2_fev1 of about 2.2, with some high outliers around 4.5 and 5. The current smoker group has slightly smaller range and variability. There is no data for nonsmokers in the dataset, so there is no way to know if there is a difference in FEV1 scores for nonsmokers.</span>
<span id="cb90-302"><a href="#cb90-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-303"><a href="#cb90-303" aria-hidden="true" tabindex="-1"></a>**Phase 2 FEV1 vs. Hay Fever** There does not appear to be any difference in phase 2 FEV1 scores for patients with or without hay fever. Patients with hay fever ("Yes" group) and patients without hay fever("No" group) have a median phase 2 FEV1 score of about 2.2. Both groups have very similar variability, with range of about 4.6. Both groups have a few high outliers above 4.5. and otherwise symmetrical distributions.</span>
<span id="cb90-304"><a href="#cb90-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-305"><a href="#cb90-305" aria-hidden="true" tabindex="-1"></a>**Phase 2 FEV1 vs. Asthma** There appears to be a difference in phase 2 FEV1 scores between patients with and without asthma. The group of patients without asthma ("No" group) has a higher median phase 2 FEV1 score around 2.2, a symmetrical distribution with roughly 7 high outliers above 4.5. The group of patients with asthma ("Yes" group) has a lower median phase 2 FEV1 score of about 1.75, a smaller range, and more symmetrical distribution than the "No" group, with only 1 outlier at about 4.8.</span>
<span id="cb90-306"><a href="#cb90-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-307"><a href="#cb90-307" aria-hidden="true" tabindex="-1"></a>**Phase 2 FEV1 vs. COPD** There appears to be a difference in phase 2 FEV1 scores between patients with and without COPD. The group of patients without COPD, ("No" group) has a median phase 2 FEV1 score of about 2.4, a range of 4.5, and roughly symmetrical distribution other than the high outliers around scores 0f 4.5 to 5. The group of patients with COPD ("Yes" group) has a lower median phase 2 FEV1 score of about 1.4, a smaller range of about 4, and a slightly more right-skewed distribution.</span>
<span id="cb90-308"><a href="#cb90-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-309"><a href="#cb90-309" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Visualize Numeric Variables by Phase 2 FEV1 Scores</span></span>
<span id="cb90-310"><a href="#cb90-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-313"><a href="#cb90-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb90-314"><a href="#cb90-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot fev1_phase2 vs. lung volume inspiratory</span></span>
<span id="cb90-315"><a href="#cb90-315" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> lung_volume_inspiratory , <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb90-316"><a href="#cb90-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb90-317"><a href="#cb90-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 Scores vs. Lung Volume Inspiratory"</span>, <span class="at">x =</span><span class="st">"Lung Volume Inspiratory (Liters)"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb90-318"><a href="#cb90-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb90-319"><a href="#cb90-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-320"><a href="#cb90-320" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot fev1_phase2 vs. lung volume expiratory</span></span>
<span id="cb90-321"><a href="#cb90-321" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> lung_volume_expiratory_log, <span class="at">y =</span> fev1_phase2))<span class="sc">+</span></span>
<span id="cb90-322"><a href="#cb90-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb90-323"><a href="#cb90-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 Scores vs. Lung Volume Expiratory (log transformed)"</span>, <span class="at">x =</span> <span class="st">"Log of Lung Volume Expiratory (Liters)"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb90-324"><a href="#cb90-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb90-325"><a href="#cb90-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-326"><a href="#cb90-326" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot fev1_phase2 vs. duration smoking</span></span>
<span id="cb90-327"><a href="#cb90-327" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> duration_smoking, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb90-328"><a href="#cb90-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb90-329"><a href="#cb90-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 Scores vs. Duration Smoking"</span>, <span class="at">x =</span> <span class="st">"Duration Smoking (Years)"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb90-330"><a href="#cb90-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb90-331"><a href="#cb90-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-332"><a href="#cb90-332" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot fev1_phase2 vs. average number of cigarettes per day</span></span>
<span id="cb90-333"><a href="#cb90-333" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> cigs_per_day_avg_log, <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb90-334"><a href="#cb90-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb90-335"><a href="#cb90-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 Scores vs. Avg Cigs per Day (log transformed)"</span>, <span class="at">x =</span> <span class="st">"Log Avg Cigs per Day"</span>, <span class="at">y =</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb90-336"><a href="#cb90-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb90-337"><a href="#cb90-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-338"><a href="#cb90-338" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot fev1_phase2 vs. Forced Vital Capacity (FVC)</span></span>
<span id="cb90-339"><a href="#cb90-339" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> COPD_data_clean, <span class="fu">aes</span>(<span class="at">x =</span> fvc , <span class="at">y =</span> fev1_phase2)) <span class="sc">+</span></span>
<span id="cb90-340"><a href="#cb90-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb90-341"><a href="#cb90-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Phase 2 FEV1 Scores vs. FVC"</span>, <span class="at">x =</span> <span class="st">"FVC"</span>, <span class="at">y=</span> <span class="st">"Phase 2 FEV1"</span>) <span class="sc">+</span> </span>
<span id="cb90-342"><a href="#cb90-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb90-343"><a href="#cb90-343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-344"><a href="#cb90-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-345"><a href="#cb90-345" aria-hidden="true" tabindex="-1"></a>**Phase 2 FEV1 vs. Lung Volume Inspiratory** There appears to be a moderate positive linear relationship between lung volume inspiratory and phase 2 FEV1 scores. The most concentrated section of data points is around lung volume inspiratory between 4 and 6 liters and phase 2 FEV1 scores between 1.5 and 3.</span>
<span id="cb90-346"><a href="#cb90-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-347"><a href="#cb90-347" aria-hidden="true" tabindex="-1"></a>**Phase 2 FEV1 vs. Log of Lung Volume Expiratory** There does not appear to be much of a relationship between lung volume expiratory and Phase 2 FEV1 scores, possibly a weak negative linear relationship, or a weak nonlinear relationship. The data is clustered around log transformed lung volume expiratory of 1, and phase 2 FEV1 score between 2 and 3.\</span>
<span id="cb90-348"><a href="#cb90-348" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb90-349"><a href="#cb90-349" aria-hidden="true" tabindex="-1"></a>**Phase 2 FEV1 vs. Duration Smoking**\</span>
<span id="cb90-350"><a href="#cb90-350" aria-hidden="true" tabindex="-1"></a>There appears to be a weak negative linear relationship between duration smoking in years and Phase 2 FEV1 scores. The data is centered around 30-50 years of smoking and phase 2 FEV1 scores between 1.5 and 3.\</span>
<span id="cb90-351"><a href="#cb90-351" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb90-352"><a href="#cb90-352" aria-hidden="true" tabindex="-1"></a>**Phase 2 FEV1 vs. Log of Avg Cigs per Day**\</span>
<span id="cb90-353"><a href="#cb90-353" aria-hidden="true" tabindex="-1"></a>There does not appear to be any relationship between the average number of cigarettes smoked per day and phase 2 FEV1 scores. There is slightly less variability in phase 2 FEV1 scores for log average cigs per day below 2 and above 4.\</span>
<span id="cb90-354"><a href="#cb90-354" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb90-355"><a href="#cb90-355" aria-hidden="true" tabindex="-1"></a>**Phase 2 FEV1 vs. FVC**\</span>
<span id="cb90-356"><a href="#cb90-356" aria-hidden="true" tabindex="-1"></a>There appears to be a strong positive linear relationship between FVC and Phase 2 FEV1 scores. The data is most concentrated between FVC of 2 and 4 and phase 2 FEV1 scores between 1.5 and 3.</span>
<span id="cb90-357"><a href="#cb90-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-358"><a href="#cb90-358" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inference and Modeling</span></span>
<span id="cb90-359"><a href="#cb90-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-360"><a href="#cb90-360" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Categorical Variables</span></span>
<span id="cb90-361"><a href="#cb90-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-362"><a href="#cb90-362" aria-hidden="true" tabindex="-1"></a>Conduct a statistical test to determine if there is a significant difference in <span class="in">`fev1_phase2`</span> between groups from categorical variables previously visualized.</span>
<span id="cb90-363"><a href="#cb90-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-364"><a href="#cb90-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r bootstrap confidence intervals as statistical test}</span></span>
<span id="cb90-365"><a href="#cb90-365" aria-hidden="true" tabindex="-1"></a><span class="co"># To determine if there is significant difference in fev1_phase2 scores between groups, I will use bootstrapping to create confidence intervals</span></span>
<span id="cb90-366"><a href="#cb90-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-367"><a href="#cb90-367" aria-hidden="true" tabindex="-1"></a><span class="co">#B = number of bootstrapped samples, n = sample size</span></span>
<span id="cb90-368"><a href="#cb90-368" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb90-369"><a href="#cb90-369" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(COPD_data_clean<span class="sc">$</span>fev1_phase2)</span>
<span id="cb90-370"><a href="#cb90-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-371"><a href="#cb90-371" aria-hidden="true" tabindex="-1"></a><span class="co">#vectors to store mean differences</span></span>
<span id="cb90-372"><a href="#cb90-372" aria-hidden="true" tabindex="-1"></a>gender_diffs  <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb90-373"><a href="#cb90-373" aria-hidden="true" tabindex="-1"></a>smoking_diffs <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb90-374"><a href="#cb90-374" aria-hidden="true" tabindex="-1"></a>hayfev_diffs  <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb90-375"><a href="#cb90-375" aria-hidden="true" tabindex="-1"></a>asthma_diffs  <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb90-376"><a href="#cb90-376" aria-hidden="true" tabindex="-1"></a>copd_diffs    <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb90-377"><a href="#cb90-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-378"><a href="#cb90-378" aria-hidden="true" tabindex="-1"></a><span class="co"># create B = 1000 samples</span></span>
<span id="cb90-379"><a href="#cb90-379" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb90-380"><a href="#cb90-380" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create random sample of dataset with replacement</span></span>
<span id="cb90-381"><a href="#cb90-381" aria-hidden="true" tabindex="-1"></a>  boot_indexes <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-382"><a href="#cb90-382" aria-hidden="true" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> COPD_data_clean[boot_indexes, ]</span>
<span id="cb90-383"><a href="#cb90-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-384"><a href="#cb90-384" aria-hidden="true" tabindex="-1"></a>  <span class="co">#subset sample by groups and phase2_fev1 scores</span></span>
<span id="cb90-385"><a href="#cb90-385" aria-hidden="true" tabindex="-1"></a>  females       <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"Female"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb90-386"><a href="#cb90-386" aria-hidden="true" tabindex="-1"></a>  males         <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"Male"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb90-387"><a href="#cb90-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-388"><a href="#cb90-388" aria-hidden="true" tabindex="-1"></a>  curr_smokers  <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>smoking_status <span class="sc">==</span> <span class="st">"Current Smoker"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb90-389"><a href="#cb90-389" aria-hidden="true" tabindex="-1"></a>  form_smokers  <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>smoking_status <span class="sc">==</span> <span class="st">"Former Smoker"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb90-390"><a href="#cb90-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-391"><a href="#cb90-391" aria-hidden="true" tabindex="-1"></a>  hay_fever_yes <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>hay_fever <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb90-392"><a href="#cb90-392" aria-hidden="true" tabindex="-1"></a>  hay_fever_no  <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>hay_fever <span class="sc">==</span> <span class="st">"No"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb90-393"><a href="#cb90-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-394"><a href="#cb90-394" aria-hidden="true" tabindex="-1"></a>  asthma_yes    <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>asthma <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb90-395"><a href="#cb90-395" aria-hidden="true" tabindex="-1"></a>  asthma_no     <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>asthma <span class="sc">==</span> <span class="st">"No"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb90-396"><a href="#cb90-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-397"><a href="#cb90-397" aria-hidden="true" tabindex="-1"></a>  copd_yes      <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>copd <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb90-398"><a href="#cb90-398" aria-hidden="true" tabindex="-1"></a>  copd_no       <span class="ot">&lt;-</span> boot_sample[boot_sample<span class="sc">$</span>copd <span class="sc">==</span> <span class="st">"No"</span>, <span class="st">"fev1_phase2"</span>]</span>
<span id="cb90-399"><a href="#cb90-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-400"><a href="#cb90-400" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calculate and store mean differences for each group</span></span>
<span id="cb90-401"><a href="#cb90-401" aria-hidden="true" tabindex="-1"></a>  gender_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(females) <span class="sc">-</span> <span class="fu">mean</span>(males)</span>
<span id="cb90-402"><a href="#cb90-402" aria-hidden="true" tabindex="-1"></a>    gender_diffs[i] <span class="ot">&lt;-</span> gender_diff</span>
<span id="cb90-403"><a href="#cb90-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-404"><a href="#cb90-404" aria-hidden="true" tabindex="-1"></a>  smoking_status_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(curr_smokers) <span class="sc">-</span> <span class="fu">mean</span>(form_smokers)</span>
<span id="cb90-405"><a href="#cb90-405" aria-hidden="true" tabindex="-1"></a>    smoking_diffs[i] <span class="ot">&lt;-</span> smoking_status_diff</span>
<span id="cb90-406"><a href="#cb90-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-407"><a href="#cb90-407" aria-hidden="true" tabindex="-1"></a>  hay_fever_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(hay_fever_no) <span class="sc">-</span> <span class="fu">mean</span>(hay_fever_yes)</span>
<span id="cb90-408"><a href="#cb90-408" aria-hidden="true" tabindex="-1"></a>    hayfev_diffs[i] <span class="ot">&lt;-</span>  hay_fever_diff</span>
<span id="cb90-409"><a href="#cb90-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-410"><a href="#cb90-410" aria-hidden="true" tabindex="-1"></a>  asthma_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(asthma_no) <span class="sc">-</span> <span class="fu">mean</span>(asthma_yes)</span>
<span id="cb90-411"><a href="#cb90-411" aria-hidden="true" tabindex="-1"></a>    asthma_diffs[i] <span class="ot">&lt;-</span>  asthma_diff</span>
<span id="cb90-412"><a href="#cb90-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-413"><a href="#cb90-413" aria-hidden="true" tabindex="-1"></a>  copd_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(copd_no) <span class="sc">-</span> <span class="fu">mean</span>(copd_yes)</span>
<span id="cb90-414"><a href="#cb90-414" aria-hidden="true" tabindex="-1"></a>    copd_diffs[i] <span class="ot">&lt;-</span> copd_diff</span>
<span id="cb90-415"><a href="#cb90-415" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-416"><a href="#cb90-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-417"><a href="#cb90-417" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Mean Difference in phase 2 FEV1 by Gender:"</span>)</span>
<span id="cb90-418"><a href="#cb90-418" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(gender_diffs, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span>
<span id="cb90-419"><a href="#cb90-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-420"><a href="#cb90-420" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Mean Difference in phase 2 FEV1 by Smoking Status:"</span>)</span>
<span id="cb90-421"><a href="#cb90-421" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(smoking_diffs, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span>
<span id="cb90-422"><a href="#cb90-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-423"><a href="#cb90-423" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Mean Difference in phase 2 FEV1 by Hay Fever:"</span>)</span>
<span id="cb90-424"><a href="#cb90-424" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(hayfev_diffs, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span>
<span id="cb90-425"><a href="#cb90-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-426"><a href="#cb90-426" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Mean Difference in phase 2 FEV1 by Asthma:"</span>)</span>
<span id="cb90-427"><a href="#cb90-427" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(asthma_diffs, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span>
<span id="cb90-428"><a href="#cb90-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-429"><a href="#cb90-429" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Mean Difference in phase 2 FEV1 by COPD:"</span>)</span>
<span id="cb90-430"><a href="#cb90-430" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(copd_diffs, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span>
<span id="cb90-431"><a href="#cb90-431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-432"><a href="#cb90-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-433"><a href="#cb90-433" aria-hidden="true" tabindex="-1"></a>Based on the bootstrapped confidence intervals I created, I can conclude that:</span>
<span id="cb90-434"><a href="#cb90-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-435"><a href="#cb90-435" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>females have significantly lower phase 2 FEV1 scores than males</span>
<span id="cb90-436"><a href="#cb90-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-437"><a href="#cb90-437" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>current smokers have significantly greater phase 2 fev1 scores than former smokers</span>
<span id="cb90-438"><a href="#cb90-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-439"><a href="#cb90-439" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>there is no significant difference in phase 2 FEV1 scores for patients with hay fever and patients who do not have hay fever (0 is contained within the interval)</span>
<span id="cb90-440"><a href="#cb90-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-441"><a href="#cb90-441" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>patients without asthma have significantly greater phase 2 fev1 scores than patients with asthma</span>
<span id="cb90-442"><a href="#cb90-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-443"><a href="#cb90-443" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>patients without COPD have signifcantly greater phase 2 fev1 scores than patients with asthma</span>
<span id="cb90-444"><a href="#cb90-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-445"><a href="#cb90-445" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Numeric Variables</span></span>
<span id="cb90-446"><a href="#cb90-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-447"><a href="#cb90-447" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Fit 5 simple linear regressions using the five numeric variables previously visualized</span>
<span id="cb90-448"><a href="#cb90-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-449"><a href="#cb90-449" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Conduct a statistical test to determine if the five slopes from regressions are significantly different from 0</span>
<span id="cb90-450"><a href="#cb90-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-451"><a href="#cb90-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r bootstrap confidence intervals on regression coefficients}</span></span>
<span id="cb90-452"><a href="#cb90-452" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. fit linear regressions</span></span>
<span id="cb90-453"><a href="#cb90-453" aria-hidden="true" tabindex="-1"></a>fit_lung_insp <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> lung_volume_inspiratory, <span class="at">data =</span> COPD_data_clean)</span>
<span id="cb90-454"><a href="#cb90-454" aria-hidden="true" tabindex="-1"></a>fit_lung_exp_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> lung_volume_expiratory_log, <span class="at">data =</span> COPD_data_clean)</span>
<span id="cb90-455"><a href="#cb90-455" aria-hidden="true" tabindex="-1"></a>fit_smoking <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> duration_smoking, <span class="at">data =</span> COPD_data_clean)</span>
<span id="cb90-456"><a href="#cb90-456" aria-hidden="true" tabindex="-1"></a>fit_cigs <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> cigs_per_day_avg_log, <span class="at">data =</span> COPD_data_clean)</span>
<span id="cb90-457"><a href="#cb90-457" aria-hidden="true" tabindex="-1"></a>fit_FVC <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> fvc, <span class="at">data =</span> COPD_data_clean)</span>
<span id="cb90-458"><a href="#cb90-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-459"><a href="#cb90-459" aria-hidden="true" tabindex="-1"></a><span class="co"># print original fitted linear models</span></span>
<span id="cb90-460"><a href="#cb90-460" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"phase2_fev1 ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_lung_insp)[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"+"</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_lung_insp)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"(lung_volume_inspiratory)"</span>))</span>
<span id="cb90-461"><a href="#cb90-461" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"phase2_fev1 ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_lung_exp_log)[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"+"</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_lung_exp_log)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"(lung_volume_expiratory_log)"</span>))</span>
<span id="cb90-462"><a href="#cb90-462" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"phase2_fev1 ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_smoking)[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"+"</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_smoking)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"(duration_smoking)"</span>))</span>
<span id="cb90-463"><a href="#cb90-463" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"phase2_fev1 ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_cigs)[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"+"</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_cigs)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"(cigs_per_day_avg_log)"</span>))</span>
<span id="cb90-464"><a href="#cb90-464" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"phase2_fev1 ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_FVC)[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"+"</span>, <span class="fu">round</span>(<span class="fu">coef</span>(fit_FVC)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"(fvc)"</span>))</span>
<span id="cb90-465"><a href="#cb90-465" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"----"</span>)</span>
<span id="cb90-466"><a href="#cb90-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-467"><a href="#cb90-467" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.</span></span>
<span id="cb90-468"><a href="#cb90-468" aria-hidden="true" tabindex="-1"></a><span class="co"># To determine if the slopes from the linear models above are different from zero, I will use bootstrapping to create confidence intervals</span></span>
<span id="cb90-469"><a href="#cb90-469" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">2000</span> <span class="co"># number of bootstrapped samples</span></span>
<span id="cb90-470"><a href="#cb90-470" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(COPD_data_clean<span class="sc">$</span>fev1_phase2) <span class="co">#sample szie</span></span>
<span id="cb90-471"><a href="#cb90-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-472"><a href="#cb90-472" aria-hidden="true" tabindex="-1"></a><span class="co">#vectors to store slopes</span></span>
<span id="cb90-473"><a href="#cb90-473" aria-hidden="true" tabindex="-1"></a>lung_in_slopes  <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb90-474"><a href="#cb90-474" aria-hidden="true" tabindex="-1"></a>lung_exp_slopes <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb90-475"><a href="#cb90-475" aria-hidden="true" tabindex="-1"></a>smoking_slopes  <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb90-476"><a href="#cb90-476" aria-hidden="true" tabindex="-1"></a>cigs_slopes     <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb90-477"><a href="#cb90-477" aria-hidden="true" tabindex="-1"></a>fvc_slopes      <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B)</span>
<span id="cb90-478"><a href="#cb90-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-479"><a href="#cb90-479" aria-hidden="true" tabindex="-1"></a><span class="co">#loop</span></span>
<span id="cb90-480"><a href="#cb90-480" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb90-481"><a href="#cb90-481" aria-hidden="true" tabindex="-1"></a>  <span class="co">#create random sample with replacement</span></span>
<span id="cb90-482"><a href="#cb90-482" aria-hidden="true" tabindex="-1"></a>  boot_indexes <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(COPD_data_clean), <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-483"><a href="#cb90-483" aria-hidden="true" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> COPD_data_clean[boot_indexes, ]</span>
<span id="cb90-484"><a href="#cb90-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-485"><a href="#cb90-485" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fit linear models</span></span>
<span id="cb90-486"><a href="#cb90-486" aria-hidden="true" tabindex="-1"></a>  boot_fit_lung_insp <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> lung_volume_inspiratory, <span class="at">data =</span> boot_sample)</span>
<span id="cb90-487"><a href="#cb90-487" aria-hidden="true" tabindex="-1"></a>  boot_fit_lung_exp_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> lung_volume_expiratory_log, <span class="at">data =</span> boot_sample)</span>
<span id="cb90-488"><a href="#cb90-488" aria-hidden="true" tabindex="-1"></a>  boot_fit_smoking <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> duration_smoking, <span class="at">data =</span> boot_sample)</span>
<span id="cb90-489"><a href="#cb90-489" aria-hidden="true" tabindex="-1"></a>  boot_fit_cigs <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> cigs_per_day_avg_log, <span class="at">data =</span> boot_sample)</span>
<span id="cb90-490"><a href="#cb90-490" aria-hidden="true" tabindex="-1"></a>  boot_fit_FVC <span class="ot">&lt;-</span> <span class="fu">lm</span>(fev1_phase2 <span class="sc">~</span> fvc, <span class="at">data =</span> boot_sample)</span>
<span id="cb90-491"><a href="#cb90-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-492"><a href="#cb90-492" aria-hidden="true" tabindex="-1"></a>  <span class="co">#store slopes</span></span>
<span id="cb90-493"><a href="#cb90-493" aria-hidden="true" tabindex="-1"></a>    lung_in_slopes[i] <span class="ot">&lt;-</span> <span class="fu">coef</span>(boot_fit_lung_insp)[<span class="dv">2</span>]</span>
<span id="cb90-494"><a href="#cb90-494" aria-hidden="true" tabindex="-1"></a>    lung_exp_slopes[i] <span class="ot">&lt;-</span> <span class="fu">coef</span>(boot_fit_lung_exp_log)[<span class="dv">2</span>]</span>
<span id="cb90-495"><a href="#cb90-495" aria-hidden="true" tabindex="-1"></a>    smoking_slopes[i] <span class="ot">&lt;-</span>  <span class="fu">coef</span>(boot_fit_smoking)[<span class="dv">2</span>]</span>
<span id="cb90-496"><a href="#cb90-496" aria-hidden="true" tabindex="-1"></a>    cigs_slopes[i]     <span class="ot">&lt;-</span>  <span class="fu">coef</span>(boot_fit_cigs)[<span class="dv">2</span>]</span>
<span id="cb90-497"><a href="#cb90-497" aria-hidden="true" tabindex="-1"></a>    fvc_slopes [i]     <span class="ot">&lt;-</span>  <span class="fu">coef</span>(boot_fit_FVC)[<span class="dv">2</span>]</span>
<span id="cb90-498"><a href="#cb90-498" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-499"><a href="#cb90-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-500"><a href="#cb90-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-501"><a href="#cb90-501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r print CI for regressions}</span></span>
<span id="cb90-502"><a href="#cb90-502" aria-hidden="true" tabindex="-1"></a><span class="co">#create and print confidence intervals for slopes</span></span>
<span id="cb90-503"><a href="#cb90-503" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% confidence interval for slope of linear regression on phase 2 FEV1 w.r.t. lung_volume_inspiratory"</span>)</span>
<span id="cb90-504"><a href="#cb90-504" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(lung_in_slopes, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span>
<span id="cb90-505"><a href="#cb90-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-506"><a href="#cb90-506" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% confidence interval for slope of linear regressionon phase 2 FEV1 w.r.t. lung_volume_expiratory_log"</span>)</span>
<span id="cb90-507"><a href="#cb90-507" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(lung_exp_slopes, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span>
<span id="cb90-508"><a href="#cb90-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-509"><a href="#cb90-509" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% confidence interval for slope of linear regression on phase 2 FEV1 w.r.t. duration_smoking"</span>)</span>
<span id="cb90-510"><a href="#cb90-510" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(smoking_slopes, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span>
<span id="cb90-511"><a href="#cb90-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-512"><a href="#cb90-512" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% confidence interval for slope of linear regression on phase 2 FEV1 w.r.t. cigs_per_day_avg_log"</span>)</span>
<span id="cb90-513"><a href="#cb90-513" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(cigs_slopes, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span>
<span id="cb90-514"><a href="#cb90-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-515"><a href="#cb90-515" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% confidence interval for slope of linear regression on phase 2 FEV1 w.r.t. fvc"</span>)</span>
<span id="cb90-516"><a href="#cb90-516" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">quantile</span>(fvc_slopes, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span>
<span id="cb90-517"><a href="#cb90-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb90-518"><a href="#cb90-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-519"><a href="#cb90-519" aria-hidden="true" tabindex="-1"></a>Based on my linear regression models, and the bootstrapped 95% confidence intervals for the slopes of the regression models, I can conclude that,</span>
<span id="cb90-520"><a href="#cb90-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-521"><a href="#cb90-521" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>lung volume inspiratory and phase 2 FEV1 are significantly correlated (the slope is significantly greater than 0) because 0 is not contained in the confidence interval</span>
<span id="cb90-522"><a href="#cb90-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-523"><a href="#cb90-523" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>lung volume expiratory (log transformed) and phase 2 FEV1 are significantly correlated (slope is significantly less than 0) because 0 is not contained within the interval</span>
<span id="cb90-524"><a href="#cb90-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-525"><a href="#cb90-525" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>duration smoking and phase 2 fev1 score are significantly correlated (slope is significantly less than 0) because 0 is not contained within the interval</span>
<span id="cb90-526"><a href="#cb90-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-527"><a href="#cb90-527" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>average number of cigarettes per day (log transformed) and phase 2 fev1 score are significantly correlated (slope is significantly less than 0) because 0 is not contained within the interval</span>
<span id="cb90-528"><a href="#cb90-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-529"><a href="#cb90-529" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>FVC and phase 2 fev1 score are significantly correlated (slope is significantly greater than 0) because 0 is not contained within the interval</span>
<span id="cb90-530"><a href="#cb90-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-531"><a href="#cb90-531" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb90-532"><a href="#cb90-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-533"><a href="#cb90-533" aria-hidden="true" tabindex="-1"></a>Affecting over 16 million Americans, chronic obstructive pulmonary disease (COPD) is commonly caused by cigarette smoking, asthma, and toxin inhalation. There is no cure for COPD; however, patients receive care to manage symptoms and slow the progression of the disease. One way to measure the severity of COPD is through spirometry. One spirometry measure is the forced expiratory volume (FEV1), which measures the volume of air forcefully exhaled in 1 second. The aim of this study was to compare patients' FEV1 scores at the five year follow up (denoted as "phase 2"), to other variables from the patient data.</span>
<span id="cb90-534"><a href="#cb90-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-535"><a href="#cb90-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-536"><a href="#cb90-536" aria-hidden="true" tabindex="-1"></a>The data used came from the COPDGene Research Group. It included separate datasets of demographic, spirometry and medical image data for 2620 patients. The datasets were merged together by patient id. The data was cleaned to remove missing values, and convert variables into more usable data types. The final dataset was 2600 rows and 41 variables. The variables included information about visit date, patientsâ€™ age, gender, race, smoking status, blood pressure, heart rate, height, weight, and bmi. There were also variables about the patient's smoking history and any respiratory illness diagnoses. Spirometry variables included lung volume inspiratory and expiratory (the volume of air in lungs at inhalation and exhalation), FEV1, FEV1 at phase 2 (follow up), forced vital capacity (FVC) and fev1_fvc ratio.</span>
<span id="cb90-537"><a href="#cb90-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-538"><a href="#cb90-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-539"><a href="#cb90-539" aria-hidden="true" tabindex="-1"></a>Exploratory analysis was performed next. A function was created to return summary statistics for numeric variables, and a frequency table for character variables. The lapply function was utilized to apply the custom function to each column in the dataset. The ggplot2 library was used to create histograms for all numeric and integer variables. After reviewing these histograms, some variables were transformed to be more normally distributed to be used for analysis. The fev1_fvc_ratio was left-skewed, so a square transformation was performed. Lung volume expiratory, emphysema percentage, average cigarettes per day, and smoking start age were all highly right skewed and log transformations were performed on these.</span>
<span id="cb90-540"><a href="#cb90-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-541"><a href="#cb90-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-542"><a href="#cb90-542" aria-hidden="true" tabindex="-1"></a>Next, to compare phase 2 FEV1 scores between different groups of patients, ggplot2 was used to create boxplots of categorical variables. The chosen categorical variables were gender, smoking status, hay fever, asthma, and copd diagnosis. The boxplots showed differences between groups for gender, asthma and copd. Scatterplots were created with ggplot2 to look for relationships between numeric variables and phase 2 fev1 scores. Lung volume inspiratory, lung volume expiratory (log-transformed), duration smoking, average number of cigarettes per day (log-transformed) and FVC were graphed as explanatory variables with phase 2 FEV1 as the response. The scatterplots for lung volume inspiratory and FVC showed positive linear relationships, while lung volume expiratory and duration smoking showed negative linear relationships.</span>
<span id="cb90-543"><a href="#cb90-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-544"><a href="#cb90-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-545"><a href="#cb90-545" aria-hidden="true" tabindex="-1"></a>Finally, bootstrapping was implemented to test the significance of the relationships seen in the data visualizations that were created. Bootstrapping is a method that involves repeatedly sampling a data sample with replacement. This process simulates the sampling distribution, which allows for statistical inference to be made through confidence intervals. Bootstrapped confidence intervals were created for the mean difference in phase 2 FEV1 scores for each of the categorical variables chosen. These confidence intervals revealed that females have significantly lower phase 2 FEV1 scores than males do, current smokers have significantly greater phase 2 FEV1 scores than former smokers, hay fever diagnosis does not relate to phase 2 fev1 scores, patients without asthma have greater phase 2 fev1 scores than patients with asthma, and patients without copd have greater phase 2 copd scores than patients without copd. The difference in phase 2 FEV1 scores between current and former smokers had a 95% confidence interval of <span class="sc">\[</span>0.09, 0.21<span class="sc">\]</span> which are relatively small values compared to the difference of patients with or without COPD, <span class="sc">\[</span>0.92, 1.04<span class="sc">\]</span>, so even though the differences for smoking status are statistically significant, they may not be clinically significant. For numeric variables, bootstrapped confidence intervals were made for the slopes of a simple linear regression model between each one of the chosen numeric variables and phase 2 FEV1 scores. As expected based on the scatterplots, the confidence intervals showed lung volume inspiratory and FVC had slopes significantly greater than zero, indicating positive linear relationships, and lung volume expiratory, duration smoking, and average cigarettes per day had slopes significantly less than zero, indicating negative linear relationships with phase 2 FEV1. Overall, many variables, categorical and quantitative, have significant relationships with phase 2 fev1 scores, so more analysis is needed to determine which variables are the most significant.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Â© 2025 Jayna Snyder</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with â¤ + <a href="https://quarto.org">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>